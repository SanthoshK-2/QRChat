import{r as zt,g as er,G as ce,a as X,S as tr,A as rr,j as W,b as lt,c as we}from"./index-BTp4L64j.js";var Me={exports:{}},Pe,ut;function nr(){if(ut)return Pe;ut=1;var x=1e3,w=x*60,I=w*60,v=I*24,N=v*7,u=v*365.25;Pe=function(B,m){m=m||{};var b=typeof B;if(b==="string"&&B.length>0)return g(B);if(b==="number"&&isFinite(B))return m.long?y(B):i(B);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(B))};function g(B){if(B=String(B),!(B.length>100)){var m=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(B);if(m){var b=parseFloat(m[1]),A=(m[2]||"ms").toLowerCase();switch(A){case"years":case"year":case"yrs":case"yr":case"y":return b*u;case"weeks":case"week":case"w":return b*N;case"days":case"day":case"d":return b*v;case"hours":case"hour":case"hrs":case"hr":case"h":return b*I;case"minutes":case"minute":case"mins":case"min":case"m":return b*w;case"seconds":case"second":case"secs":case"sec":case"s":return b*x;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return b;default:return}}}}function i(B){var m=Math.abs(B);return m>=v?Math.round(B/v)+"d":m>=I?Math.round(B/I)+"h":m>=w?Math.round(B/w)+"m":m>=x?Math.round(B/x)+"s":B+"ms"}function y(B){var m=Math.abs(B);return m>=v?T(B,m,v,"day"):m>=I?T(B,m,I,"hour"):m>=w?T(B,m,w,"minute"):m>=x?T(B,m,x,"second"):B+" ms"}function T(B,m,b,A){var o=m>=b*1.5;return Math.round(B/b)+" "+A+(o?"s":"")}return Pe}var je,ft;function ir(){if(ft)return je;ft=1;function x(w){v.debug=v,v.default=v,v.coerce=T,v.disable=i,v.enable=u,v.enabled=y,v.humanize=nr(),v.destroy=B,Object.keys(w).forEach(m=>{v[m]=w[m]}),v.names=[],v.skips=[],v.formatters={};function I(m){let b=0;for(let A=0;A<m.length;A++)b=(b<<5)-b+m.charCodeAt(A),b|=0;return v.colors[Math.abs(b)%v.colors.length]}v.selectColor=I;function v(m){let b,A=null,o,d;function h(...l){if(!h.enabled)return;const _=h,M=Number(new Date),p=M-(b||M);_.diff=p,_.prev=b,_.curr=M,b=M,l[0]=v.coerce(l[0]),typeof l[0]!="string"&&l.unshift("%O");let c=0;l[0]=l[0].replace(/%([a-zA-Z%])/g,(O,k)=>{if(O==="%%")return"%";c++;const U=v.formatters[k];if(typeof U=="function"){const q=l[c];O=U.call(_,q),l.splice(c,1),c--}return O}),v.formatArgs.call(_,l),(_.log||v.log).apply(_,l)}return h.namespace=m,h.useColors=v.useColors(),h.color=v.selectColor(m),h.extend=N,h.destroy=v.destroy,Object.defineProperty(h,"enabled",{enumerable:!0,configurable:!1,get:()=>A!==null?A:(o!==v.namespaces&&(o=v.namespaces,d=v.enabled(m)),d),set:l=>{A=l}}),typeof v.init=="function"&&v.init(h),h}function N(m,b){const A=v(this.namespace+(typeof b>"u"?":":b)+m);return A.log=this.log,A}function u(m){v.save(m),v.namespaces=m,v.names=[],v.skips=[];const b=(typeof m=="string"?m:"").trim().replace(/\s+/g,",").split(",").filter(Boolean);for(const A of b)A[0]==="-"?v.skips.push(A.slice(1)):v.names.push(A)}function g(m,b){let A=0,o=0,d=-1,h=0;for(;A<m.length;)if(o<b.length&&(b[o]===m[A]||b[o]==="*"))b[o]==="*"?(d=o,h=A,o++):(A++,o++);else if(d!==-1)o=d+1,h++,A=h;else return!1;for(;o<b.length&&b[o]==="*";)o++;return o===b.length}function i(){const m=[...v.names,...v.skips.map(b=>"-"+b)].join(",");return v.enable(""),m}function y(m){for(const b of v.skips)if(g(m,b))return!1;for(const b of v.names)if(g(m,b))return!0;return!1}function T(m){return m instanceof Error?m.stack||m.message:m}function B(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return v.enable(v.load()),v}return je=x,je}var ct;function or(){return ct||(ct=1,(function(x,w){var I={};w.formatArgs=N,w.save=u,w.load=g,w.useColors=v,w.storage=i(),w.destroy=(()=>{let T=!1;return()=>{T||(T=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),w.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function v(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let T;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(T=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(T[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function N(T){if(T[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+T[0]+(this.useColors?"%c ":" ")+"+"+x.exports.humanize(this.diff),!this.useColors)return;const B="color: "+this.color;T.splice(1,0,B,"color: inherit");let m=0,b=0;T[0].replace(/%[a-zA-Z%]/g,A=>{A!=="%%"&&(m++,A==="%c"&&(b=m))}),T.splice(b,0,B)}w.log=console.debug||console.log||(()=>{});function u(T){try{T?w.storage.setItem("debug",T):w.storage.removeItem("debug")}catch{}}function g(){let T;try{T=w.storage.getItem("debug")||w.storage.getItem("DEBUG")}catch{}return!T&&typeof process<"u"&&"env"in process&&(T=I.DEBUG),T}function i(){try{return localStorage}catch{}}x.exports=ir()(w);const{formatters:y}=x.exports;y.j=function(T){try{return JSON.stringify(T)}catch(B){return"[UnexpectedJSONParseError]: "+B.message}}})(Me,Me.exports)),Me.exports}var Ue,ht;function sr(){return ht||(ht=1,Ue=function(){if(typeof globalThis>"u")return null;var w={RTCPeerConnection:globalThis.RTCPeerConnection||globalThis.mozRTCPeerConnection||globalThis.webkitRTCPeerConnection,RTCSessionDescription:globalThis.RTCSessionDescription||globalThis.mozRTCSessionDescription||globalThis.webkitRTCSessionDescription,RTCIceCandidate:globalThis.RTCIceCandidate||globalThis.mozRTCIceCandidate||globalThis.webkitRTCIceCandidate};return w.RTCPeerConnection?w:null}),Ue}var Fe={exports:{}},Le={exports:{}},qe={},Ae={},dt;function ar(){if(dt)return Ae;dt=1,Ae.byteLength=i,Ae.toByteArray=T,Ae.fromByteArray=b;for(var x=[],w=[],I=typeof Uint8Array<"u"?Uint8Array:Array,v="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",N=0,u=v.length;N<u;++N)x[N]=v[N],w[v.charCodeAt(N)]=N;w[45]=62,w[95]=63;function g(A){var o=A.length;if(o%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var d=A.indexOf("=");d===-1&&(d=o);var h=d===o?0:4-d%4;return[d,h]}function i(A){var o=g(A),d=o[0],h=o[1];return(d+h)*3/4-h}function y(A,o,d){return(o+d)*3/4-d}function T(A){var o,d=g(A),h=d[0],l=d[1],_=new I(y(A,h,l)),M=0,p=l>0?h-4:h,c;for(c=0;c<p;c+=4)o=w[A.charCodeAt(c)]<<18|w[A.charCodeAt(c+1)]<<12|w[A.charCodeAt(c+2)]<<6|w[A.charCodeAt(c+3)],_[M++]=o>>16&255,_[M++]=o>>8&255,_[M++]=o&255;return l===2&&(o=w[A.charCodeAt(c)]<<2|w[A.charCodeAt(c+1)]>>4,_[M++]=o&255),l===1&&(o=w[A.charCodeAt(c)]<<10|w[A.charCodeAt(c+1)]<<4|w[A.charCodeAt(c+2)]>>2,_[M++]=o>>8&255,_[M++]=o&255),_}function B(A){return x[A>>18&63]+x[A>>12&63]+x[A>>6&63]+x[A&63]}function m(A,o,d){for(var h,l=[],_=o;_<d;_+=3)h=(A[_]<<16&16711680)+(A[_+1]<<8&65280)+(A[_+2]&255),l.push(B(h));return l.join("")}function b(A){for(var o,d=A.length,h=d%3,l=[],_=16383,M=0,p=d-h;M<p;M+=_)l.push(m(A,M,M+_>p?p:M+_));return h===1?(o=A[d-1],l.push(x[o>>2]+x[o<<4&63]+"==")):h===2&&(o=(A[d-2]<<8)+A[d-1],l.push(x[o>>10]+x[o>>4&63]+x[o<<2&63]+"=")),l.join("")}return Ae}var Ne={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */var pt;function lr(){return pt||(pt=1,Ne.read=function(x,w,I,v,N){var u,g,i=N*8-v-1,y=(1<<i)-1,T=y>>1,B=-7,m=I?N-1:0,b=I?-1:1,A=x[w+m];for(m+=b,u=A&(1<<-B)-1,A>>=-B,B+=i;B>0;u=u*256+x[w+m],m+=b,B-=8);for(g=u&(1<<-B)-1,u>>=-B,B+=v;B>0;g=g*256+x[w+m],m+=b,B-=8);if(u===0)u=1-T;else{if(u===y)return g?NaN:(A?-1:1)*(1/0);g=g+Math.pow(2,v),u=u-T}return(A?-1:1)*g*Math.pow(2,u-v)},Ne.write=function(x,w,I,v,N,u){var g,i,y,T=u*8-N-1,B=(1<<T)-1,m=B>>1,b=N===23?Math.pow(2,-24)-Math.pow(2,-77):0,A=v?0:u-1,o=v?1:-1,d=w<0||w===0&&1/w<0?1:0;for(w=Math.abs(w),isNaN(w)||w===1/0?(i=isNaN(w)?1:0,g=B):(g=Math.floor(Math.log(w)/Math.LN2),w*(y=Math.pow(2,-g))<1&&(g--,y*=2),g+m>=1?w+=b/y:w+=b*Math.pow(2,1-m),w*y>=2&&(g++,y/=2),g+m>=B?(i=0,g=B):g+m>=1?(i=(w*y-1)*Math.pow(2,N),g=g+m):(i=w*Math.pow(2,m-1)*Math.pow(2,N),g=0));N>=8;x[I+A]=i&255,A+=o,i/=256,N-=8);for(g=g<<N|i,T+=N;T>0;x[I+A]=g&255,A+=o,g/=256,T-=8);x[I+A-o]|=d*128}),Ne}/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var gt;function Ie(){return gt||(gt=1,(function(x){const w=ar(),I=lr(),v=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;x.Buffer=i,x.SlowBuffer=_,x.INSPECT_MAX_BYTES=50;const N=2147483647;x.kMaxLength=N,i.TYPED_ARRAY_SUPPORT=u(),!i.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function u(){try{const r=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(r,e),r.foo()===42}catch{return!1}}Object.defineProperty(i.prototype,"parent",{enumerable:!0,get:function(){if(i.isBuffer(this))return this.buffer}}),Object.defineProperty(i.prototype,"offset",{enumerable:!0,get:function(){if(i.isBuffer(this))return this.byteOffset}});function g(r){if(r>N)throw new RangeError('The value "'+r+'" is invalid for option "size"');const e=new Uint8Array(r);return Object.setPrototypeOf(e,i.prototype),e}function i(r,e,t){if(typeof r=="number"){if(typeof e=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return m(r)}return y(r,e,t)}i.poolSize=8192;function y(r,e,t){if(typeof r=="string")return b(r,e);if(ArrayBuffer.isView(r))return o(r);if(r==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof r);if(se(r,ArrayBuffer)||r&&se(r.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(se(r,SharedArrayBuffer)||r&&se(r.buffer,SharedArrayBuffer)))return d(r,e,t);if(typeof r=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const a=r.valueOf&&r.valueOf();if(a!=null&&a!==r)return i.from(a,e,t);const f=h(r);if(f)return f;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof r[Symbol.toPrimitive]=="function")return i.from(r[Symbol.toPrimitive]("string"),e,t);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof r)}i.from=function(r,e,t){return y(r,e,t)},Object.setPrototypeOf(i.prototype,Uint8Array.prototype),Object.setPrototypeOf(i,Uint8Array);function T(r){if(typeof r!="number")throw new TypeError('"size" argument must be of type number');if(r<0)throw new RangeError('The value "'+r+'" is invalid for option "size"')}function B(r,e,t){return T(r),r<=0?g(r):e!==void 0?typeof t=="string"?g(r).fill(e,t):g(r).fill(e):g(r)}i.alloc=function(r,e,t){return B(r,e,t)};function m(r){return T(r),g(r<0?0:l(r)|0)}i.allocUnsafe=function(r){return m(r)},i.allocUnsafeSlow=function(r){return m(r)};function b(r,e){if((typeof e!="string"||e==="")&&(e="utf8"),!i.isEncoding(e))throw new TypeError("Unknown encoding: "+e);const t=M(r,e)|0;let a=g(t);const f=a.write(r,e);return f!==t&&(a=a.slice(0,f)),a}function A(r){const e=r.length<0?0:l(r.length)|0,t=g(e);for(let a=0;a<e;a+=1)t[a]=r[a]&255;return t}function o(r){if(se(r,Uint8Array)){const e=new Uint8Array(r);return d(e.buffer,e.byteOffset,e.byteLength)}return A(r)}function d(r,e,t){if(e<0||r.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(r.byteLength<e+(t||0))throw new RangeError('"length" is outside of buffer bounds');let a;return e===void 0&&t===void 0?a=new Uint8Array(r):t===void 0?a=new Uint8Array(r,e):a=new Uint8Array(r,e,t),Object.setPrototypeOf(a,i.prototype),a}function h(r){if(i.isBuffer(r)){const e=l(r.length)|0,t=g(e);return t.length===0||r.copy(t,0,0,e),t}if(r.length!==void 0)return typeof r.length!="number"||me(r.length)?g(0):A(r);if(r.type==="Buffer"&&Array.isArray(r.data))return A(r.data)}function l(r){if(r>=N)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+N.toString(16)+" bytes");return r|0}function _(r){return+r!=r&&(r=0),i.alloc(+r)}i.isBuffer=function(e){return e!=null&&e._isBuffer===!0&&e!==i.prototype},i.compare=function(e,t){if(se(e,Uint8Array)&&(e=i.from(e,e.offset,e.byteLength)),se(t,Uint8Array)&&(t=i.from(t,t.offset,t.byteLength)),!i.isBuffer(e)||!i.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let a=e.length,f=t.length;for(let S=0,F=Math.min(a,f);S<F;++S)if(e[S]!==t[S]){a=e[S],f=t[S];break}return a<f?-1:f<a?1:0},i.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},i.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(e.length===0)return i.alloc(0);let a;if(t===void 0)for(t=0,a=0;a<e.length;++a)t+=e[a].length;const f=i.allocUnsafe(t);let S=0;for(a=0;a<e.length;++a){let F=e[a];if(se(F,Uint8Array))S+F.length>f.length?(i.isBuffer(F)||(F=i.from(F)),F.copy(f,S)):Uint8Array.prototype.set.call(f,F,S);else if(i.isBuffer(F))F.copy(f,S);else throw new TypeError('"list" argument must be an Array of Buffers');S+=F.length}return f};function M(r,e){if(i.isBuffer(r))return r.length;if(ArrayBuffer.isView(r)||se(r,ArrayBuffer))return r.byteLength;if(typeof r!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof r);const t=r.length,a=arguments.length>2&&arguments[2]===!0;if(!a&&t===0)return 0;let f=!1;for(;;)switch(e){case"ascii":case"latin1":case"binary":return t;case"utf8":case"utf-8":return z(r).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return t*2;case"hex":return t>>>1;case"base64":return Se(r).length;default:if(f)return a?-1:z(r).length;e=(""+e).toLowerCase(),f=!0}}i.byteLength=M;function p(r,e,t){let a=!1;if((e===void 0||e<0)&&(e=0),e>this.length||((t===void 0||t>this.length)&&(t=this.length),t<=0)||(t>>>=0,e>>>=0,t<=e))return"";for(r||(r="utf8");;)switch(r){case"hex":return de(this,e,t);case"utf8":case"utf-8":return ie(this,e,t);case"ascii":return oe(this,e,t);case"latin1":case"binary":return ge(this,e,t);case"base64":return ne(this,e,t);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return pe(this,e,t);default:if(a)throw new TypeError("Unknown encoding: "+r);r=(r+"").toLowerCase(),a=!0}}i.prototype._isBuffer=!0;function c(r,e,t){const a=r[e];r[e]=r[t],r[t]=a}i.prototype.swap16=function(){const e=this.length;if(e%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)c(this,t,t+1);return this},i.prototype.swap32=function(){const e=this.length;if(e%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)c(this,t,t+3),c(this,t+1,t+2);return this},i.prototype.swap64=function(){const e=this.length;if(e%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)c(this,t,t+7),c(this,t+1,t+6),c(this,t+2,t+5),c(this,t+3,t+4);return this},i.prototype.toString=function(){const e=this.length;return e===0?"":arguments.length===0?ie(this,0,e):p.apply(this,arguments)},i.prototype.toLocaleString=i.prototype.toString,i.prototype.equals=function(e){if(!i.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e?!0:i.compare(this,e)===0},i.prototype.inspect=function(){let e="";const t=x.INSPECT_MAX_BYTES;return e=this.toString("hex",0,t).replace(/(.{2})/g,"$1 ").trim(),this.length>t&&(e+=" ... "),"<Buffer "+e+">"},v&&(i.prototype[v]=i.prototype.inspect),i.prototype.compare=function(e,t,a,f,S){if(se(e,Uint8Array)&&(e=i.from(e,e.offset,e.byteLength)),!i.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(t===void 0&&(t=0),a===void 0&&(a=e?e.length:0),f===void 0&&(f=0),S===void 0&&(S=this.length),t<0||a>e.length||f<0||S>this.length)throw new RangeError("out of range index");if(f>=S&&t>=a)return 0;if(f>=S)return-1;if(t>=a)return 1;if(t>>>=0,a>>>=0,f>>>=0,S>>>=0,this===e)return 0;let F=S-f,G=a-t;const ee=Math.min(F,G),Z=this.slice(f,S),te=e.slice(t,a);for(let K=0;K<ee;++K)if(Z[K]!==te[K]){F=Z[K],G=te[K];break}return F<G?-1:G<F?1:0};function E(r,e,t,a,f){if(r.length===0)return-1;if(typeof t=="string"?(a=t,t=0):t>2147483647?t=2147483647:t<-2147483648&&(t=-2147483648),t=+t,me(t)&&(t=f?0:r.length-1),t<0&&(t=r.length+t),t>=r.length){if(f)return-1;t=r.length-1}else if(t<0)if(f)t=0;else return-1;if(typeof e=="string"&&(e=i.from(e,a)),i.isBuffer(e))return e.length===0?-1:O(r,e,t,a,f);if(typeof e=="number")return e=e&255,typeof Uint8Array.prototype.indexOf=="function"?f?Uint8Array.prototype.indexOf.call(r,e,t):Uint8Array.prototype.lastIndexOf.call(r,e,t):O(r,[e],t,a,f);throw new TypeError("val must be string, number or Buffer")}function O(r,e,t,a,f){let S=1,F=r.length,G=e.length;if(a!==void 0&&(a=String(a).toLowerCase(),a==="ucs2"||a==="ucs-2"||a==="utf16le"||a==="utf-16le")){if(r.length<2||e.length<2)return-1;S=2,F/=2,G/=2,t/=2}function ee(te,K){return S===1?te[K]:te.readUInt16BE(K*S)}let Z;if(f){let te=-1;for(Z=t;Z<F;Z++)if(ee(r,Z)===ee(e,te===-1?0:Z-te)){if(te===-1&&(te=Z),Z-te+1===G)return te*S}else te!==-1&&(Z-=Z-te),te=-1}else for(t+G>F&&(t=F-G),Z=t;Z>=0;Z--){let te=!0;for(let K=0;K<G;K++)if(ee(r,Z+K)!==ee(e,K)){te=!1;break}if(te)return Z}return-1}i.prototype.includes=function(e,t,a){return this.indexOf(e,t,a)!==-1},i.prototype.indexOf=function(e,t,a){return E(this,e,t,a,!0)},i.prototype.lastIndexOf=function(e,t,a){return E(this,e,t,a,!1)};function k(r,e,t,a){t=Number(t)||0;const f=r.length-t;a?(a=Number(a),a>f&&(a=f)):a=f;const S=e.length;a>S/2&&(a=S/2);let F;for(F=0;F<a;++F){const G=parseInt(e.substr(F*2,2),16);if(me(G))return F;r[t+F]=G}return F}function U(r,e,t,a){return Re(z(e,r.length-t),r,t,a)}function q(r,e,t,a){return Re(_e(e),r,t,a)}function $(r,e,t,a){return Re(Se(e),r,t,a)}function re(r,e,t,a){return Re(ve(e,r.length-t),r,t,a)}i.prototype.write=function(e,t,a,f){if(t===void 0)f="utf8",a=this.length,t=0;else if(a===void 0&&typeof t=="string")f=t,a=this.length,t=0;else if(isFinite(t))t=t>>>0,isFinite(a)?(a=a>>>0,f===void 0&&(f="utf8")):(f=a,a=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const S=this.length-t;if((a===void 0||a>S)&&(a=S),e.length>0&&(a<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");f||(f="utf8");let F=!1;for(;;)switch(f){case"hex":return k(this,e,t,a);case"utf8":case"utf-8":return U(this,e,t,a);case"ascii":case"latin1":case"binary":return q(this,e,t,a);case"base64":return $(this,e,t,a);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return re(this,e,t,a);default:if(F)throw new TypeError("Unknown encoding: "+f);f=(""+f).toLowerCase(),F=!0}},i.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function ne(r,e,t){return e===0&&t===r.length?w.fromByteArray(r):w.fromByteArray(r.slice(e,t))}function ie(r,e,t){t=Math.min(r.length,t);const a=[];let f=e;for(;f<t;){const S=r[f];let F=null,G=S>239?4:S>223?3:S>191?2:1;if(f+G<=t){let ee,Z,te,K;switch(G){case 1:S<128&&(F=S);break;case 2:ee=r[f+1],(ee&192)===128&&(K=(S&31)<<6|ee&63,K>127&&(F=K));break;case 3:ee=r[f+1],Z=r[f+2],(ee&192)===128&&(Z&192)===128&&(K=(S&15)<<12|(ee&63)<<6|Z&63,K>2047&&(K<55296||K>57343)&&(F=K));break;case 4:ee=r[f+1],Z=r[f+2],te=r[f+3],(ee&192)===128&&(Z&192)===128&&(te&192)===128&&(K=(S&15)<<18|(ee&63)<<12|(Z&63)<<6|te&63,K>65535&&K<1114112&&(F=K))}}F===null?(F=65533,G=1):F>65535&&(F-=65536,a.push(F>>>10&1023|55296),F=56320|F&1023),a.push(F),f+=G}return he(a)}const ae=4096;function he(r){const e=r.length;if(e<=ae)return String.fromCharCode.apply(String,r);let t="",a=0;for(;a<e;)t+=String.fromCharCode.apply(String,r.slice(a,a+=ae));return t}function oe(r,e,t){let a="";t=Math.min(r.length,t);for(let f=e;f<t;++f)a+=String.fromCharCode(r[f]&127);return a}function ge(r,e,t){let a="";t=Math.min(r.length,t);for(let f=e;f<t;++f)a+=String.fromCharCode(r[f]);return a}function de(r,e,t){const a=r.length;(!e||e<0)&&(e=0),(!t||t<0||t>a)&&(t=a);let f="";for(let S=e;S<t;++S)f+=Te[r[S]];return f}function pe(r,e,t){const a=r.slice(e,t);let f="";for(let S=0;S<a.length-1;S+=2)f+=String.fromCharCode(a[S]+a[S+1]*256);return f}i.prototype.slice=function(e,t){const a=this.length;e=~~e,t=t===void 0?a:~~t,e<0?(e+=a,e<0&&(e=0)):e>a&&(e=a),t<0?(t+=a,t<0&&(t=0)):t>a&&(t=a),t<e&&(t=e);const f=this.subarray(e,t);return Object.setPrototypeOf(f,i.prototype),f};function J(r,e,t){if(r%1!==0||r<0)throw new RangeError("offset is not uint");if(r+e>t)throw new RangeError("Trying to access beyond buffer length")}i.prototype.readUintLE=i.prototype.readUIntLE=function(e,t,a){e=e>>>0,t=t>>>0,a||J(e,t,this.length);let f=this[e],S=1,F=0;for(;++F<t&&(S*=256);)f+=this[e+F]*S;return f},i.prototype.readUintBE=i.prototype.readUIntBE=function(e,t,a){e=e>>>0,t=t>>>0,a||J(e,t,this.length);let f=this[e+--t],S=1;for(;t>0&&(S*=256);)f+=this[e+--t]*S;return f},i.prototype.readUint8=i.prototype.readUInt8=function(e,t){return e=e>>>0,t||J(e,1,this.length),this[e]},i.prototype.readUint16LE=i.prototype.readUInt16LE=function(e,t){return e=e>>>0,t||J(e,2,this.length),this[e]|this[e+1]<<8},i.prototype.readUint16BE=i.prototype.readUInt16BE=function(e,t){return e=e>>>0,t||J(e,2,this.length),this[e]<<8|this[e+1]},i.prototype.readUint32LE=i.prototype.readUInt32LE=function(e,t){return e=e>>>0,t||J(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+this[e+3]*16777216},i.prototype.readUint32BE=i.prototype.readUInt32BE=function(e,t){return e=e>>>0,t||J(e,4,this.length),this[e]*16777216+(this[e+1]<<16|this[e+2]<<8|this[e+3])},i.prototype.readBigUInt64LE=ue(function(e){e=e>>>0,L(e,"offset");const t=this[e],a=this[e+7];(t===void 0||a===void 0)&&j(e,this.length-8);const f=t+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24,S=this[++e]+this[++e]*2**8+this[++e]*2**16+a*2**24;return BigInt(f)+(BigInt(S)<<BigInt(32))}),i.prototype.readBigUInt64BE=ue(function(e){e=e>>>0,L(e,"offset");const t=this[e],a=this[e+7];(t===void 0||a===void 0)&&j(e,this.length-8);const f=t*2**24+this[++e]*2**16+this[++e]*2**8+this[++e],S=this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+a;return(BigInt(f)<<BigInt(32))+BigInt(S)}),i.prototype.readIntLE=function(e,t,a){e=e>>>0,t=t>>>0,a||J(e,t,this.length);let f=this[e],S=1,F=0;for(;++F<t&&(S*=256);)f+=this[e+F]*S;return S*=128,f>=S&&(f-=Math.pow(2,8*t)),f},i.prototype.readIntBE=function(e,t,a){e=e>>>0,t=t>>>0,a||J(e,t,this.length);let f=t,S=1,F=this[e+--f];for(;f>0&&(S*=256);)F+=this[e+--f]*S;return S*=128,F>=S&&(F-=Math.pow(2,8*t)),F},i.prototype.readInt8=function(e,t){return e=e>>>0,t||J(e,1,this.length),this[e]&128?(255-this[e]+1)*-1:this[e]},i.prototype.readInt16LE=function(e,t){e=e>>>0,t||J(e,2,this.length);const a=this[e]|this[e+1]<<8;return a&32768?a|4294901760:a},i.prototype.readInt16BE=function(e,t){e=e>>>0,t||J(e,2,this.length);const a=this[e+1]|this[e]<<8;return a&32768?a|4294901760:a},i.prototype.readInt32LE=function(e,t){return e=e>>>0,t||J(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},i.prototype.readInt32BE=function(e,t){return e=e>>>0,t||J(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},i.prototype.readBigInt64LE=ue(function(e){e=e>>>0,L(e,"offset");const t=this[e],a=this[e+7];(t===void 0||a===void 0)&&j(e,this.length-8);const f=this[e+4]+this[e+5]*2**8+this[e+6]*2**16+(a<<24);return(BigInt(f)<<BigInt(32))+BigInt(t+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24)}),i.prototype.readBigInt64BE=ue(function(e){e=e>>>0,L(e,"offset");const t=this[e],a=this[e+7];(t===void 0||a===void 0)&&j(e,this.length-8);const f=(t<<24)+this[++e]*2**16+this[++e]*2**8+this[++e];return(BigInt(f)<<BigInt(32))+BigInt(this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+a)}),i.prototype.readFloatLE=function(e,t){return e=e>>>0,t||J(e,4,this.length),I.read(this,e,!0,23,4)},i.prototype.readFloatBE=function(e,t){return e=e>>>0,t||J(e,4,this.length),I.read(this,e,!1,23,4)},i.prototype.readDoubleLE=function(e,t){return e=e>>>0,t||J(e,8,this.length),I.read(this,e,!0,52,8)},i.prototype.readDoubleBE=function(e,t){return e=e>>>0,t||J(e,8,this.length),I.read(this,e,!1,52,8)};function Q(r,e,t,a,f,S){if(!i.isBuffer(r))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>f||e<S)throw new RangeError('"value" argument is out of bounds');if(t+a>r.length)throw new RangeError("Index out of range")}i.prototype.writeUintLE=i.prototype.writeUIntLE=function(e,t,a,f){if(e=+e,t=t>>>0,a=a>>>0,!f){const G=Math.pow(2,8*a)-1;Q(this,e,t,a,G,0)}let S=1,F=0;for(this[t]=e&255;++F<a&&(S*=256);)this[t+F]=e/S&255;return t+a},i.prototype.writeUintBE=i.prototype.writeUIntBE=function(e,t,a,f){if(e=+e,t=t>>>0,a=a>>>0,!f){const G=Math.pow(2,8*a)-1;Q(this,e,t,a,G,0)}let S=a-1,F=1;for(this[t+S]=e&255;--S>=0&&(F*=256);)this[t+S]=e/F&255;return t+a},i.prototype.writeUint8=i.prototype.writeUInt8=function(e,t,a){return e=+e,t=t>>>0,a||Q(this,e,t,1,255,0),this[t]=e&255,t+1},i.prototype.writeUint16LE=i.prototype.writeUInt16LE=function(e,t,a){return e=+e,t=t>>>0,a||Q(this,e,t,2,65535,0),this[t]=e&255,this[t+1]=e>>>8,t+2},i.prototype.writeUint16BE=i.prototype.writeUInt16BE=function(e,t,a){return e=+e,t=t>>>0,a||Q(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=e&255,t+2},i.prototype.writeUint32LE=i.prototype.writeUInt32LE=function(e,t,a){return e=+e,t=t>>>0,a||Q(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=e&255,t+4},i.prototype.writeUint32BE=i.prototype.writeUInt32BE=function(e,t,a){return e=+e,t=t>>>0,a||Q(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=e&255,t+4};function le(r,e,t,a,f){s(e,a,f,r,t,7);let S=Number(e&BigInt(4294967295));r[t++]=S,S=S>>8,r[t++]=S,S=S>>8,r[t++]=S,S=S>>8,r[t++]=S;let F=Number(e>>BigInt(32)&BigInt(4294967295));return r[t++]=F,F=F>>8,r[t++]=F,F=F>>8,r[t++]=F,F=F>>8,r[t++]=F,t}function ye(r,e,t,a,f){s(e,a,f,r,t,7);let S=Number(e&BigInt(4294967295));r[t+7]=S,S=S>>8,r[t+6]=S,S=S>>8,r[t+5]=S,S=S>>8,r[t+4]=S;let F=Number(e>>BigInt(32)&BigInt(4294967295));return r[t+3]=F,F=F>>8,r[t+2]=F,F=F>>8,r[t+1]=F,F=F>>8,r[t]=F,t+8}i.prototype.writeBigUInt64LE=ue(function(e,t=0){return le(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))}),i.prototype.writeBigUInt64BE=ue(function(e,t=0){return ye(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))}),i.prototype.writeIntLE=function(e,t,a,f){if(e=+e,t=t>>>0,!f){const ee=Math.pow(2,8*a-1);Q(this,e,t,a,ee-1,-ee)}let S=0,F=1,G=0;for(this[t]=e&255;++S<a&&(F*=256);)e<0&&G===0&&this[t+S-1]!==0&&(G=1),this[t+S]=(e/F>>0)-G&255;return t+a},i.prototype.writeIntBE=function(e,t,a,f){if(e=+e,t=t>>>0,!f){const ee=Math.pow(2,8*a-1);Q(this,e,t,a,ee-1,-ee)}let S=a-1,F=1,G=0;for(this[t+S]=e&255;--S>=0&&(F*=256);)e<0&&G===0&&this[t+S+1]!==0&&(G=1),this[t+S]=(e/F>>0)-G&255;return t+a},i.prototype.writeInt8=function(e,t,a){return e=+e,t=t>>>0,a||Q(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=e&255,t+1},i.prototype.writeInt16LE=function(e,t,a){return e=+e,t=t>>>0,a||Q(this,e,t,2,32767,-32768),this[t]=e&255,this[t+1]=e>>>8,t+2},i.prototype.writeInt16BE=function(e,t,a){return e=+e,t=t>>>0,a||Q(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=e&255,t+2},i.prototype.writeInt32LE=function(e,t,a){return e=+e,t=t>>>0,a||Q(this,e,t,4,2147483647,-2147483648),this[t]=e&255,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},i.prototype.writeInt32BE=function(e,t,a){return e=+e,t=t>>>0,a||Q(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=e&255,t+4},i.prototype.writeBigInt64LE=ue(function(e,t=0){return le(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),i.prototype.writeBigInt64BE=ue(function(e,t=0){return ye(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function fe(r,e,t,a,f,S){if(t+a>r.length)throw new RangeError("Index out of range");if(t<0)throw new RangeError("Index out of range")}function C(r,e,t,a,f){return e=+e,t=t>>>0,f||fe(r,e,t,4),I.write(r,e,t,a,23,4),t+4}i.prototype.writeFloatLE=function(e,t,a){return C(this,e,t,!0,a)},i.prototype.writeFloatBE=function(e,t,a){return C(this,e,t,!1,a)};function R(r,e,t,a,f){return e=+e,t=t>>>0,f||fe(r,e,t,8),I.write(r,e,t,a,52,8),t+8}i.prototype.writeDoubleLE=function(e,t,a){return R(this,e,t,!0,a)},i.prototype.writeDoubleBE=function(e,t,a){return R(this,e,t,!1,a)},i.prototype.copy=function(e,t,a,f){if(!i.isBuffer(e))throw new TypeError("argument should be a Buffer");if(a||(a=0),!f&&f!==0&&(f=this.length),t>=e.length&&(t=e.length),t||(t=0),f>0&&f<a&&(f=a),f===a||e.length===0||this.length===0)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(a<0||a>=this.length)throw new RangeError("Index out of range");if(f<0)throw new RangeError("sourceEnd out of bounds");f>this.length&&(f=this.length),e.length-t<f-a&&(f=e.length-t+a);const S=f-a;return this===e&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(t,a,f):Uint8Array.prototype.set.call(e,this.subarray(a,f),t),S},i.prototype.fill=function(e,t,a,f){if(typeof e=="string"){if(typeof t=="string"?(f=t,t=0,a=this.length):typeof a=="string"&&(f=a,a=this.length),f!==void 0&&typeof f!="string")throw new TypeError("encoding must be a string");if(typeof f=="string"&&!i.isEncoding(f))throw new TypeError("Unknown encoding: "+f);if(e.length===1){const F=e.charCodeAt(0);(f==="utf8"&&F<128||f==="latin1")&&(e=F)}}else typeof e=="number"?e=e&255:typeof e=="boolean"&&(e=Number(e));if(t<0||this.length<t||this.length<a)throw new RangeError("Out of range index");if(a<=t)return this;t=t>>>0,a=a===void 0?this.length:a>>>0,e||(e=0);let S;if(typeof e=="number")for(S=t;S<a;++S)this[S]=e;else{const F=i.isBuffer(e)?e:i.from(e,f),G=F.length;if(G===0)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(S=0;S<a-t;++S)this[S+t]=F[S%G]}return this};const P={};function H(r,e,t){P[r]=class extends t{constructor(){super(),Object.defineProperty(this,"message",{value:e.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${r}]`,this.stack,delete this.name}get code(){return r}set code(f){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:f,writable:!0})}toString(){return`${this.name} [${r}]: ${this.message}`}}}H("ERR_BUFFER_OUT_OF_BOUNDS",function(r){return r?`${r} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),H("ERR_INVALID_ARG_TYPE",function(r,e){return`The "${r}" argument must be of type number. Received type ${typeof e}`},TypeError),H("ERR_OUT_OF_RANGE",function(r,e,t){let a=`The value of "${r}" is out of range.`,f=t;return Number.isInteger(t)&&Math.abs(t)>2**32?f=D(String(t)):typeof t=="bigint"&&(f=String(t),(t>BigInt(2)**BigInt(32)||t<-(BigInt(2)**BigInt(32)))&&(f=D(f)),f+="n"),a+=` It must be ${e}. Received ${f}`,a},RangeError);function D(r){let e="",t=r.length;const a=r[0]==="-"?1:0;for(;t>=a+4;t-=3)e=`_${r.slice(t-3,t)}${e}`;return`${r.slice(0,t)}${e}`}function n(r,e,t){L(e,"offset"),(r[e]===void 0||r[e+t]===void 0)&&j(e,r.length-(t+1))}function s(r,e,t,a,f,S){if(r>t||r<e){const F=typeof e=="bigint"?"n":"";let G;throw e===0||e===BigInt(0)?G=`>= 0${F} and < 2${F} ** ${(S+1)*8}${F}`:G=`>= -(2${F} ** ${(S+1)*8-1}${F}) and < 2 ** ${(S+1)*8-1}${F}`,new P.ERR_OUT_OF_RANGE("value",G,r)}n(a,f,S)}function L(r,e){if(typeof r!="number")throw new P.ERR_INVALID_ARG_TYPE(e,"number",r)}function j(r,e,t){throw Math.floor(r)!==r?(L(r,t),new P.ERR_OUT_OF_RANGE("offset","an integer",r)):e<0?new P.ERR_BUFFER_OUT_OF_BOUNDS:new P.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${e}`,r)}const Y=/[^+/0-9A-Za-z-_]/g;function V(r){if(r=r.split("=")[0],r=r.trim().replace(Y,""),r.length<2)return"";for(;r.length%4!==0;)r=r+"=";return r}function z(r,e){e=e||1/0;let t;const a=r.length;let f=null;const S=[];for(let F=0;F<a;++F){if(t=r.charCodeAt(F),t>55295&&t<57344){if(!f){if(t>56319){(e-=3)>-1&&S.push(239,191,189);continue}else if(F+1===a){(e-=3)>-1&&S.push(239,191,189);continue}f=t;continue}if(t<56320){(e-=3)>-1&&S.push(239,191,189),f=t;continue}t=(f-55296<<10|t-56320)+65536}else f&&(e-=3)>-1&&S.push(239,191,189);if(f=null,t<128){if((e-=1)<0)break;S.push(t)}else if(t<2048){if((e-=2)<0)break;S.push(t>>6|192,t&63|128)}else if(t<65536){if((e-=3)<0)break;S.push(t>>12|224,t>>6&63|128,t&63|128)}else if(t<1114112){if((e-=4)<0)break;S.push(t>>18|240,t>>12&63|128,t>>6&63|128,t&63|128)}else throw new Error("Invalid code point")}return S}function _e(r){const e=[];for(let t=0;t<r.length;++t)e.push(r.charCodeAt(t)&255);return e}function ve(r,e){let t,a,f;const S=[];for(let F=0;F<r.length&&!((e-=2)<0);++F)t=r.charCodeAt(F),a=t>>8,f=t%256,S.push(f),S.push(a);return S}function Se(r){return w.toByteArray(V(r))}function Re(r,e,t,a){let f;for(f=0;f<a&&!(f+t>=e.length||f>=r.length);++f)e[f+t]=r[f];return f}function se(r,e){return r instanceof e||r!=null&&r.constructor!=null&&r.constructor.name!=null&&r.constructor.name===e.name}function me(r){return r!==r}const Te=(function(){const r="0123456789abcdef",e=new Array(256);for(let t=0;t<16;++t){const a=t*16;for(let f=0;f<16;++f)e[a+f]=r[t]+r[f]}return e})();function ue(r){return typeof BigInt>"u"?be:r}function be(){throw new Error("BigInt not supported")}})(qe)),qe}/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */var yt;function Gt(){return yt||(yt=1,(function(x,w){var I=Ie(),v=I.Buffer;function N(g,i){for(var y in g)i[y]=g[y]}v.from&&v.alloc&&v.allocUnsafe&&v.allocUnsafeSlow?x.exports=I:(N(I,w),w.Buffer=u);function u(g,i,y){return v(g,i,y)}u.prototype=Object.create(v.prototype),N(v,u),u.from=function(g,i,y){if(typeof g=="number")throw new TypeError("Argument must not be a number");return v(g,i,y)},u.alloc=function(g,i,y){if(typeof g!="number")throw new TypeError("Argument must be a number");var T=v(g);return i!==void 0?typeof y=="string"?T.fill(i,y):T.fill(i):T.fill(0),T},u.allocUnsafe=function(g){if(typeof g!="number")throw new TypeError("Argument must be a number");return v(g)},u.allocUnsafeSlow=function(g){if(typeof g!="number")throw new TypeError("Argument must be a number");return I.SlowBuffer(g)}})(Le,Le.exports)),Le.exports}var _t;function ur(){if(_t)return Fe.exports;_t=1;var x=65536,w=4294967295;function I(){throw new Error(`Secure random number generation is not supported by this browser.
Use Chrome, Firefox or Internet Explorer 11`)}var v=Gt().Buffer,N=globalThis.crypto||globalThis.msCrypto;N&&N.getRandomValues?Fe.exports=u:Fe.exports=I;function u(g,i){if(g>w)throw new RangeError("requested too many random bytes");var y=v.allocUnsafe(g);if(g>0)if(g>x)for(var T=0;T<g;T+=x)N.getRandomValues(y.slice(T,T+x));else N.getRandomValues(y);return typeof i=="function"?process.nextTick(function(){i(null,y)}):y}return Fe.exports}var Oe={exports:{}},ke={exports:{}},wt;function Yt(){if(wt)return ke.exports;wt=1;var x=typeof Reflect=="object"?Reflect:null,w=x&&typeof x.apply=="function"?x.apply:function(c,E,O){return Function.prototype.apply.call(c,E,O)},I;x&&typeof x.ownKeys=="function"?I=x.ownKeys:Object.getOwnPropertySymbols?I=function(c){return Object.getOwnPropertyNames(c).concat(Object.getOwnPropertySymbols(c))}:I=function(c){return Object.getOwnPropertyNames(c)};function v(p){console&&console.warn&&console.warn(p)}var N=Number.isNaN||function(c){return c!==c};function u(){u.init.call(this)}ke.exports=u,ke.exports.once=l,u.EventEmitter=u,u.prototype._events=void 0,u.prototype._eventsCount=0,u.prototype._maxListeners=void 0;var g=10;function i(p){if(typeof p!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof p)}Object.defineProperty(u,"defaultMaxListeners",{enumerable:!0,get:function(){return g},set:function(p){if(typeof p!="number"||p<0||N(p))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+p+".");g=p}}),u.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},u.prototype.setMaxListeners=function(c){if(typeof c!="number"||c<0||N(c))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+c+".");return this._maxListeners=c,this};function y(p){return p._maxListeners===void 0?u.defaultMaxListeners:p._maxListeners}u.prototype.getMaxListeners=function(){return y(this)},u.prototype.emit=function(c){for(var E=[],O=1;O<arguments.length;O++)E.push(arguments[O]);var k=c==="error",U=this._events;if(U!==void 0)k=k&&U.error===void 0;else if(!k)return!1;if(k){var q;if(E.length>0&&(q=E[0]),q instanceof Error)throw q;var $=new Error("Unhandled error."+(q?" ("+q.message+")":""));throw $.context=q,$}var re=U[c];if(re===void 0)return!1;if(typeof re=="function")w(re,this,E);else for(var ne=re.length,ie=o(re,ne),O=0;O<ne;++O)w(ie[O],this,E);return!0};function T(p,c,E,O){var k,U,q;if(i(E),U=p._events,U===void 0?(U=p._events=Object.create(null),p._eventsCount=0):(U.newListener!==void 0&&(p.emit("newListener",c,E.listener?E.listener:E),U=p._events),q=U[c]),q===void 0)q=U[c]=E,++p._eventsCount;else if(typeof q=="function"?q=U[c]=O?[E,q]:[q,E]:O?q.unshift(E):q.push(E),k=y(p),k>0&&q.length>k&&!q.warned){q.warned=!0;var $=new Error("Possible EventEmitter memory leak detected. "+q.length+" "+String(c)+" listeners added. Use emitter.setMaxListeners() to increase limit");$.name="MaxListenersExceededWarning",$.emitter=p,$.type=c,$.count=q.length,v($)}return p}u.prototype.addListener=function(c,E){return T(this,c,E,!1)},u.prototype.on=u.prototype.addListener,u.prototype.prependListener=function(c,E){return T(this,c,E,!0)};function B(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function m(p,c,E){var O={fired:!1,wrapFn:void 0,target:p,type:c,listener:E},k=B.bind(O);return k.listener=E,O.wrapFn=k,k}u.prototype.once=function(c,E){return i(E),this.on(c,m(this,c,E)),this},u.prototype.prependOnceListener=function(c,E){return i(E),this.prependListener(c,m(this,c,E)),this},u.prototype.removeListener=function(c,E){var O,k,U,q,$;if(i(E),k=this._events,k===void 0)return this;if(O=k[c],O===void 0)return this;if(O===E||O.listener===E)--this._eventsCount===0?this._events=Object.create(null):(delete k[c],k.removeListener&&this.emit("removeListener",c,O.listener||E));else if(typeof O!="function"){for(U=-1,q=O.length-1;q>=0;q--)if(O[q]===E||O[q].listener===E){$=O[q].listener,U=q;break}if(U<0)return this;U===0?O.shift():d(O,U),O.length===1&&(k[c]=O[0]),k.removeListener!==void 0&&this.emit("removeListener",c,$||E)}return this},u.prototype.off=u.prototype.removeListener,u.prototype.removeAllListeners=function(c){var E,O,k;if(O=this._events,O===void 0)return this;if(O.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):O[c]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete O[c]),this;if(arguments.length===0){var U=Object.keys(O),q;for(k=0;k<U.length;++k)q=U[k],q!=="removeListener"&&this.removeAllListeners(q);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(E=O[c],typeof E=="function")this.removeListener(c,E);else if(E!==void 0)for(k=E.length-1;k>=0;k--)this.removeListener(c,E[k]);return this};function b(p,c,E){var O=p._events;if(O===void 0)return[];var k=O[c];return k===void 0?[]:typeof k=="function"?E?[k.listener||k]:[k]:E?h(k):o(k,k.length)}u.prototype.listeners=function(c){return b(this,c,!0)},u.prototype.rawListeners=function(c){return b(this,c,!1)},u.listenerCount=function(p,c){return typeof p.listenerCount=="function"?p.listenerCount(c):A.call(p,c)},u.prototype.listenerCount=A;function A(p){var c=this._events;if(c!==void 0){var E=c[p];if(typeof E=="function")return 1;if(E!==void 0)return E.length}return 0}u.prototype.eventNames=function(){return this._eventsCount>0?I(this._events):[]};function o(p,c){for(var E=new Array(c),O=0;O<c;++O)E[O]=p[O];return E}function d(p,c){for(;c+1<p.length;c++)p[c]=p[c+1];p.pop()}function h(p){for(var c=new Array(p.length),E=0;E<c.length;++E)c[E]=p[E].listener||p[E];return c}function l(p,c){return new Promise(function(E,O){function k(q){p.removeListener(c,U),O(q)}function U(){typeof p.removeListener=="function"&&p.removeListener("error",k),E([].slice.call(arguments))}M(p,c,U,{once:!0}),c!=="error"&&_(p,k,{once:!0})})}function _(p,c,E){typeof p.on=="function"&&M(p,"error",c,E)}function M(p,c,E,O){if(typeof p.on=="function")O.once?p.once(c,E):p.on(c,E);else if(typeof p.addEventListener=="function")p.addEventListener(c,function k(U){O.once&&p.removeEventListener(c,k),E(U)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof p)}return ke.exports}var He,mt;function $t(){return mt||(mt=1,He=Yt().EventEmitter),He}var We,bt;function fr(){if(bt)return We;bt=1;function x(o,d){var h=Object.keys(o);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(o);d&&(l=l.filter(function(_){return Object.getOwnPropertyDescriptor(o,_).enumerable})),h.push.apply(h,l)}return h}function w(o){for(var d=1;d<arguments.length;d++){var h=arguments[d]!=null?arguments[d]:{};d%2?x(Object(h),!0).forEach(function(l){I(o,l,h[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(h)):x(Object(h)).forEach(function(l){Object.defineProperty(o,l,Object.getOwnPropertyDescriptor(h,l))})}return o}function I(o,d,h){return d=g(d),d in o?Object.defineProperty(o,d,{value:h,enumerable:!0,configurable:!0,writable:!0}):o[d]=h,o}function v(o,d){if(!(o instanceof d))throw new TypeError("Cannot call a class as a function")}function N(o,d){for(var h=0;h<d.length;h++){var l=d[h];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(o,g(l.key),l)}}function u(o,d,h){return d&&N(o.prototype,d),Object.defineProperty(o,"prototype",{writable:!1}),o}function g(o){var d=i(o,"string");return typeof d=="symbol"?d:String(d)}function i(o,d){if(typeof o!="object"||o===null)return o;var h=o[Symbol.toPrimitive];if(h!==void 0){var l=h.call(o,d);if(typeof l!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(o)}var y=Ie(),T=y.Buffer,B=zt,m=B.inspect,b=m&&m.custom||"inspect";function A(o,d,h){T.prototype.copy.call(o,d,h)}return We=(function(){function o(){v(this,o),this.head=null,this.tail=null,this.length=0}return u(o,[{key:"push",value:function(h){var l={data:h,next:null};this.length>0?this.tail.next=l:this.head=l,this.tail=l,++this.length}},{key:"unshift",value:function(h){var l={data:h,next:this.head};this.length===0&&(this.tail=l),this.head=l,++this.length}},{key:"shift",value:function(){if(this.length!==0){var h=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,h}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(h){if(this.length===0)return"";for(var l=this.head,_=""+l.data;l=l.next;)_+=h+l.data;return _}},{key:"concat",value:function(h){if(this.length===0)return T.alloc(0);for(var l=T.allocUnsafe(h>>>0),_=this.head,M=0;_;)A(_.data,l,M),M+=_.data.length,_=_.next;return l}},{key:"consume",value:function(h,l){var _;return h<this.head.data.length?(_=this.head.data.slice(0,h),this.head.data=this.head.data.slice(h)):h===this.head.data.length?_=this.shift():_=l?this._getString(h):this._getBuffer(h),_}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(h){var l=this.head,_=1,M=l.data;for(h-=M.length;l=l.next;){var p=l.data,c=h>p.length?p.length:h;if(c===p.length?M+=p:M+=p.slice(0,h),h-=c,h===0){c===p.length?(++_,l.next?this.head=l.next:this.head=this.tail=null):(this.head=l,l.data=p.slice(c));break}++_}return this.length-=_,M}},{key:"_getBuffer",value:function(h){var l=T.allocUnsafe(h),_=this.head,M=1;for(_.data.copy(l),h-=_.data.length;_=_.next;){var p=_.data,c=h>p.length?p.length:h;if(p.copy(l,l.length-h,0,c),h-=c,h===0){c===p.length?(++M,_.next?this.head=_.next:this.head=this.tail=null):(this.head=_,_.data=p.slice(c));break}++M}return this.length-=M,l}},{key:b,value:function(h,l){return m(this,w(w({},l),{},{depth:0,customInspect:!1}))}}]),o})(),We}var Ve,Et;function Kt(){if(Et)return Ve;Et=1;function x(g,i){var y=this,T=this._readableState&&this._readableState.destroyed,B=this._writableState&&this._writableState.destroyed;return T||B?(i?i(g):g&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,process.nextTick(N,this,g)):process.nextTick(N,this,g)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(g||null,function(m){!i&&m?y._writableState?y._writableState.errorEmitted?process.nextTick(I,y):(y._writableState.errorEmitted=!0,process.nextTick(w,y,m)):process.nextTick(w,y,m):i?(process.nextTick(I,y),i(m)):process.nextTick(I,y)}),this)}function w(g,i){N(g,i),I(g)}function I(g){g._writableState&&!g._writableState.emitClose||g._readableState&&!g._readableState.emitClose||g.emit("close")}function v(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function N(g,i){g.emit("error",i)}function u(g,i){var y=g._readableState,T=g._writableState;y&&y.autoDestroy||T&&T.autoDestroy?g.destroy(i):g.emit("error",i)}return Ve={destroy:x,undestroy:v,errorOrDestroy:u},Ve}var ze={},vt;function Ce(){if(vt)return ze;vt=1;function x(i,y){i.prototype=Object.create(y.prototype),i.prototype.constructor=i,i.__proto__=y}var w={};function I(i,y,T){T||(T=Error);function B(b,A,o){return typeof y=="string"?y:y(b,A,o)}var m=(function(b){x(A,b);function A(o,d,h){return b.call(this,B(o,d,h))||this}return A})(T);m.prototype.name=T.name,m.prototype.code=i,w[i]=m}function v(i,y){if(Array.isArray(i)){var T=i.length;return i=i.map(function(B){return String(B)}),T>2?"one of ".concat(y," ").concat(i.slice(0,T-1).join(", "),", or ")+i[T-1]:T===2?"one of ".concat(y," ").concat(i[0]," or ").concat(i[1]):"of ".concat(y," ").concat(i[0])}else return"of ".concat(y," ").concat(String(i))}function N(i,y,T){return i.substr(0,y.length)===y}function u(i,y,T){return(T===void 0||T>i.length)&&(T=i.length),i.substring(T-y.length,T)===y}function g(i,y,T){return typeof T!="number"&&(T=0),T+y.length>i.length?!1:i.indexOf(y,T)!==-1}return I("ERR_INVALID_OPT_VALUE",function(i,y){return'The value "'+y+'" is invalid for option "'+i+'"'},TypeError),I("ERR_INVALID_ARG_TYPE",function(i,y,T){var B;typeof y=="string"&&N(y,"not ")?(B="must not be",y=y.replace(/^not /,"")):B="must be";var m;if(u(i," argument"))m="The ".concat(i," ").concat(B," ").concat(v(y,"type"));else{var b=g(i,".")?"property":"argument";m='The "'.concat(i,'" ').concat(b," ").concat(B," ").concat(v(y,"type"))}return m+=". Received type ".concat(typeof T),m},TypeError),I("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),I("ERR_METHOD_NOT_IMPLEMENTED",function(i){return"The "+i+" method is not implemented"}),I("ERR_STREAM_PREMATURE_CLOSE","Premature close"),I("ERR_STREAM_DESTROYED",function(i){return"Cannot call "+i+" after a stream was destroyed"}),I("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),I("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),I("ERR_STREAM_WRITE_AFTER_END","write after end"),I("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),I("ERR_UNKNOWN_ENCODING",function(i){return"Unknown encoding: "+i},TypeError),I("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),ze.codes=w,ze}var Ge,Rt;function Xt(){if(Rt)return Ge;Rt=1;var x=Ce().codes.ERR_INVALID_OPT_VALUE;function w(v,N,u){return v.highWaterMark!=null?v.highWaterMark:N?v[u]:null}function I(v,N,u,g){var i=w(N,g,u);if(i!=null){if(!(isFinite(i)&&Math.floor(i)===i)||i<0){var y=g?u:"highWaterMark";throw new x(y,i)}return Math.floor(i)}return v.objectMode?16:16*1024}return Ge={getHighWaterMark:I},Ge}var De={exports:{}},xt;function Be(){return xt||(xt=1,typeof Object.create=="function"?De.exports=function(w,I){I&&(w.super_=I,w.prototype=Object.create(I.prototype,{constructor:{value:w,enumerable:!1,writable:!0,configurable:!0}}))}:De.exports=function(w,I){if(I){w.super_=I;var v=function(){};v.prototype=I.prototype,w.prototype=new v,w.prototype.constructor=w}}),De.exports}var Ye,Ct;function cr(){if(Ct)return Ye;Ct=1,Ye=x;function x(I,v){if(w("noDeprecation"))return I;var N=!1;function u(){if(!N){if(w("throwDeprecation"))throw new Error(v);w("traceDeprecation")?console.trace(v):console.warn(v),N=!0}return I.apply(this,arguments)}return u}function w(I){try{if(!globalThis.localStorage)return!1}catch{return!1}var v=globalThis.localStorage[I];return v==null?!1:String(v).toLowerCase()==="true"}return Ye}var $e,St;function Jt(){if(St)return $e;St=1,$e=k;function x(C){var R=this;this.next=null,this.entry=null,this.finish=function(){fe(R,C)}}var w;k.WritableState=E;var I={deprecate:cr()},v=$t(),N=Ie().Buffer,u=(typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function g(C){return N.from(C)}function i(C){return N.isBuffer(C)||C instanceof u}var y=Kt(),T=Xt(),B=T.getHighWaterMark,m=Ce().codes,b=m.ERR_INVALID_ARG_TYPE,A=m.ERR_METHOD_NOT_IMPLEMENTED,o=m.ERR_MULTIPLE_CALLBACK,d=m.ERR_STREAM_CANNOT_PIPE,h=m.ERR_STREAM_DESTROYED,l=m.ERR_STREAM_NULL_VALUES,_=m.ERR_STREAM_WRITE_AFTER_END,M=m.ERR_UNKNOWN_ENCODING,p=y.errorOrDestroy;Be()(k,v);function c(){}function E(C,R,P){w=w||xe(),C=C||{},typeof P!="boolean"&&(P=R instanceof w),this.objectMode=!!C.objectMode,P&&(this.objectMode=this.objectMode||!!C.writableObjectMode),this.highWaterMark=B(this,C,"writableHighWaterMark",P),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var H=C.decodeStrings===!1;this.decodeStrings=!H,this.defaultEncoding=C.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(D){he(R,D)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=C.emitClose!==!1,this.autoDestroy=!!C.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new x(this)}E.prototype.getBuffer=function(){for(var R=this.bufferedRequest,P=[];R;)P.push(R),R=R.next;return P},(function(){try{Object.defineProperty(E.prototype,"buffer",{get:I.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}})();var O;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(O=Function.prototype[Symbol.hasInstance],Object.defineProperty(k,Symbol.hasInstance,{value:function(R){return O.call(this,R)?!0:this!==k?!1:R&&R._writableState instanceof E}})):O=function(R){return R instanceof this};function k(C){w=w||xe();var R=this instanceof w;if(!R&&!O.call(k,this))return new k(C);this._writableState=new E(C,this,R),this.writable=!0,C&&(typeof C.write=="function"&&(this._write=C.write),typeof C.writev=="function"&&(this._writev=C.writev),typeof C.destroy=="function"&&(this._destroy=C.destroy),typeof C.final=="function"&&(this._final=C.final)),v.call(this)}k.prototype.pipe=function(){p(this,new d)};function U(C,R){var P=new _;p(C,P),process.nextTick(R,P)}function q(C,R,P,H){var D;return P===null?D=new l:typeof P!="string"&&!R.objectMode&&(D=new b("chunk",["string","Buffer"],P)),D?(p(C,D),process.nextTick(H,D),!1):!0}k.prototype.write=function(C,R,P){var H=this._writableState,D=!1,n=!H.objectMode&&i(C);return n&&!N.isBuffer(C)&&(C=g(C)),typeof R=="function"&&(P=R,R=null),n?R="buffer":R||(R=H.defaultEncoding),typeof P!="function"&&(P=c),H.ending?U(this,P):(n||q(this,H,C,P))&&(H.pendingcb++,D=re(this,H,n,C,R,P)),D},k.prototype.cork=function(){this._writableState.corked++},k.prototype.uncork=function(){var C=this._writableState;C.corked&&(C.corked--,!C.writing&&!C.corked&&!C.bufferProcessing&&C.bufferedRequest&&de(this,C))},k.prototype.setDefaultEncoding=function(R){if(typeof R=="string"&&(R=R.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((R+"").toLowerCase())>-1))throw new M(R);return this._writableState.defaultEncoding=R,this},Object.defineProperty(k.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});function $(C,R,P){return!C.objectMode&&C.decodeStrings!==!1&&typeof R=="string"&&(R=N.from(R,P)),R}Object.defineProperty(k.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function re(C,R,P,H,D,n){if(!P){var s=$(R,H,D);H!==s&&(P=!0,D="buffer",H=s)}var L=R.objectMode?1:H.length;R.length+=L;var j=R.length<R.highWaterMark;if(j||(R.needDrain=!0),R.writing||R.corked){var Y=R.lastBufferedRequest;R.lastBufferedRequest={chunk:H,encoding:D,isBuf:P,callback:n,next:null},Y?Y.next=R.lastBufferedRequest:R.bufferedRequest=R.lastBufferedRequest,R.bufferedRequestCount+=1}else ne(C,R,!1,L,H,D,n);return j}function ne(C,R,P,H,D,n,s){R.writelen=H,R.writecb=s,R.writing=!0,R.sync=!0,R.destroyed?R.onwrite(new h("write")):P?C._writev(D,R.onwrite):C._write(D,n,R.onwrite),R.sync=!1}function ie(C,R,P,H,D){--R.pendingcb,P?(process.nextTick(D,H),process.nextTick(le,C,R),C._writableState.errorEmitted=!0,p(C,H)):(D(H),C._writableState.errorEmitted=!0,p(C,H),le(C,R))}function ae(C){C.writing=!1,C.writecb=null,C.length-=C.writelen,C.writelen=0}function he(C,R){var P=C._writableState,H=P.sync,D=P.writecb;if(typeof D!="function")throw new o;if(ae(P),R)ie(C,P,H,R,D);else{var n=pe(P)||C.destroyed;!n&&!P.corked&&!P.bufferProcessing&&P.bufferedRequest&&de(C,P),H?process.nextTick(oe,C,P,n,D):oe(C,P,n,D)}}function oe(C,R,P,H){P||ge(C,R),R.pendingcb--,H(),le(C,R)}function ge(C,R){R.length===0&&R.needDrain&&(R.needDrain=!1,C.emit("drain"))}function de(C,R){R.bufferProcessing=!0;var P=R.bufferedRequest;if(C._writev&&P&&P.next){var H=R.bufferedRequestCount,D=new Array(H),n=R.corkedRequestsFree;n.entry=P;for(var s=0,L=!0;P;)D[s]=P,P.isBuf||(L=!1),P=P.next,s+=1;D.allBuffers=L,ne(C,R,!0,R.length,D,"",n.finish),R.pendingcb++,R.lastBufferedRequest=null,n.next?(R.corkedRequestsFree=n.next,n.next=null):R.corkedRequestsFree=new x(R),R.bufferedRequestCount=0}else{for(;P;){var j=P.chunk,Y=P.encoding,V=P.callback,z=R.objectMode?1:j.length;if(ne(C,R,!1,z,j,Y,V),P=P.next,R.bufferedRequestCount--,R.writing)break}P===null&&(R.lastBufferedRequest=null)}R.bufferedRequest=P,R.bufferProcessing=!1}k.prototype._write=function(C,R,P){P(new A("_write()"))},k.prototype._writev=null,k.prototype.end=function(C,R,P){var H=this._writableState;return typeof C=="function"?(P=C,C=null,R=null):typeof R=="function"&&(P=R,R=null),C!=null&&this.write(C,R),H.corked&&(H.corked=1,this.uncork()),H.ending||ye(this,H,P),this},Object.defineProperty(k.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function pe(C){return C.ending&&C.length===0&&C.bufferedRequest===null&&!C.finished&&!C.writing}function J(C,R){C._final(function(P){R.pendingcb--,P&&p(C,P),R.prefinished=!0,C.emit("prefinish"),le(C,R)})}function Q(C,R){!R.prefinished&&!R.finalCalled&&(typeof C._final=="function"&&!R.destroyed?(R.pendingcb++,R.finalCalled=!0,process.nextTick(J,C,R)):(R.prefinished=!0,C.emit("prefinish")))}function le(C,R){var P=pe(R);if(P&&(Q(C,R),R.pendingcb===0&&(R.finished=!0,C.emit("finish"),R.autoDestroy))){var H=C._readableState;(!H||H.autoDestroy&&H.endEmitted)&&C.destroy()}return P}function ye(C,R,P){R.ending=!0,le(C,R),P&&(R.finished?process.nextTick(P):C.once("finish",P)),R.ended=!0,C.writable=!1}function fe(C,R,P){var H=C.entry;for(C.entry=null;H;){var D=H.callback;R.pendingcb--,D(P),H=H.next}R.corkedRequestsFree.next=C}return Object.defineProperty(k.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(R){this._writableState&&(this._writableState.destroyed=R)}}),k.prototype.destroy=y.destroy,k.prototype._undestroy=y.undestroy,k.prototype._destroy=function(C,R){R(C)},$e}var Ke,Tt;function xe(){if(Tt)return Ke;Tt=1;var x=Object.keys||function(T){var B=[];for(var m in T)B.push(m);return B};Ke=g;var w=Zt(),I=Jt();Be()(g,w);for(var v=x(I.prototype),N=0;N<v.length;N++){var u=v[N];g.prototype[u]||(g.prototype[u]=I.prototype[u])}function g(T){if(!(this instanceof g))return new g(T);w.call(this,T),I.call(this,T),this.allowHalfOpen=!0,T&&(T.readable===!1&&(this.readable=!1),T.writable===!1&&(this.writable=!1),T.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",i)))}Object.defineProperty(g.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(g.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(g.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function i(){this._writableState.ended||process.nextTick(y,this)}function y(T){T.end()}return Object.defineProperty(g.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(B){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=B,this._writableState.destroyed=B)}}),Ke}var Xe={},At;function It(){if(At)return Xe;At=1;var x=Gt().Buffer,w=x.isEncoding||function(l){switch(l=""+l,l&&l.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function I(l){if(!l)return"utf8";for(var _;;)switch(l){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return l;default:if(_)return;l=(""+l).toLowerCase(),_=!0}}function v(l){var _=I(l);if(typeof _!="string"&&(x.isEncoding===w||!w(l)))throw new Error("Unknown encoding: "+l);return _||l}Xe.StringDecoder=N;function N(l){this.encoding=v(l);var _;switch(this.encoding){case"utf16le":this.text=m,this.end=b,_=4;break;case"utf8":this.fillLast=y,_=4;break;case"base64":this.text=A,this.end=o,_=3;break;default:this.write=d,this.end=h;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=x.allocUnsafe(_)}N.prototype.write=function(l){if(l.length===0)return"";var _,M;if(this.lastNeed){if(_=this.fillLast(l),_===void 0)return"";M=this.lastNeed,this.lastNeed=0}else M=0;return M<l.length?_?_+this.text(l,M):this.text(l,M):_||""},N.prototype.end=B,N.prototype.text=T,N.prototype.fillLast=function(l){if(this.lastNeed<=l.length)return l.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);l.copy(this.lastChar,this.lastTotal-this.lastNeed,0,l.length),this.lastNeed-=l.length};function u(l){return l<=127?0:l>>5===6?2:l>>4===14?3:l>>3===30?4:l>>6===2?-1:-2}function g(l,_,M){var p=_.length-1;if(p<M)return 0;var c=u(_[p]);return c>=0?(c>0&&(l.lastNeed=c-1),c):--p<M||c===-2?0:(c=u(_[p]),c>=0?(c>0&&(l.lastNeed=c-2),c):--p<M||c===-2?0:(c=u(_[p]),c>=0?(c>0&&(c===2?c=0:l.lastNeed=c-3),c):0))}function i(l,_,M){if((_[0]&192)!==128)return l.lastNeed=0,"";if(l.lastNeed>1&&_.length>1){if((_[1]&192)!==128)return l.lastNeed=1,"";if(l.lastNeed>2&&_.length>2&&(_[2]&192)!==128)return l.lastNeed=2,""}}function y(l){var _=this.lastTotal-this.lastNeed,M=i(this,l);if(M!==void 0)return M;if(this.lastNeed<=l.length)return l.copy(this.lastChar,_,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);l.copy(this.lastChar,_,0,l.length),this.lastNeed-=l.length}function T(l,_){var M=g(this,l,_);if(!this.lastNeed)return l.toString("utf8",_);this.lastTotal=M;var p=l.length-(M-this.lastNeed);return l.copy(this.lastChar,0,p),l.toString("utf8",_,p)}function B(l){var _=l&&l.length?this.write(l):"";return this.lastNeed?_+"":_}function m(l,_){if((l.length-_)%2===0){var M=l.toString("utf16le",_);if(M){var p=M.charCodeAt(M.length-1);if(p>=55296&&p<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=l[l.length-2],this.lastChar[1]=l[l.length-1],M.slice(0,-1)}return M}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=l[l.length-1],l.toString("utf16le",_,l.length-1)}function b(l){var _=l&&l.length?this.write(l):"";if(this.lastNeed){var M=this.lastTotal-this.lastNeed;return _+this.lastChar.toString("utf16le",0,M)}return _}function A(l,_){var M=(l.length-_)%3;return M===0?l.toString("base64",_):(this.lastNeed=3-M,this.lastTotal=3,M===1?this.lastChar[0]=l[l.length-1]:(this.lastChar[0]=l[l.length-2],this.lastChar[1]=l[l.length-1]),l.toString("base64",_,l.length-M))}function o(l){var _=l&&l.length?this.write(l):"";return this.lastNeed?_+this.lastChar.toString("base64",0,3-this.lastNeed):_}function d(l){return l.toString(this.encoding)}function h(l){return l&&l.length?this.write(l):""}return Xe}var Je,Bt;function at(){if(Bt)return Je;Bt=1;var x=Ce().codes.ERR_STREAM_PREMATURE_CLOSE;function w(u){var g=!1;return function(){if(!g){g=!0;for(var i=arguments.length,y=new Array(i),T=0;T<i;T++)y[T]=arguments[T];u.apply(this,y)}}}function I(){}function v(u){return u.setHeader&&typeof u.abort=="function"}function N(u,g,i){if(typeof g=="function")return N(u,null,g);g||(g={}),i=w(i||I);var y=g.readable||g.readable!==!1&&u.readable,T=g.writable||g.writable!==!1&&u.writable,B=function(){u.writable||b()},m=u._writableState&&u._writableState.finished,b=function(){T=!1,m=!0,y||i.call(u)},A=u._readableState&&u._readableState.endEmitted,o=function(){y=!1,A=!0,T||i.call(u)},d=function(M){i.call(u,M)},h=function(){var M;if(y&&!A)return(!u._readableState||!u._readableState.ended)&&(M=new x),i.call(u,M);if(T&&!m)return(!u._writableState||!u._writableState.ended)&&(M=new x),i.call(u,M)},l=function(){u.req.on("finish",b)};return v(u)?(u.on("complete",b),u.on("abort",h),u.req?l():u.on("request",l)):T&&!u._writableState&&(u.on("end",B),u.on("close",B)),u.on("end",o),u.on("finish",b),g.error!==!1&&u.on("error",d),u.on("close",h),function(){u.removeListener("complete",b),u.removeListener("abort",h),u.removeListener("request",l),u.req&&u.req.removeListener("finish",b),u.removeListener("end",B),u.removeListener("close",B),u.removeListener("finish",b),u.removeListener("end",o),u.removeListener("error",d),u.removeListener("close",h)}}return Je=N,Je}var Ze,Mt;function hr(){if(Mt)return Ze;Mt=1;var x;function w(M,p,c){return p=I(p),p in M?Object.defineProperty(M,p,{value:c,enumerable:!0,configurable:!0,writable:!0}):M[p]=c,M}function I(M){var p=v(M,"string");return typeof p=="symbol"?p:String(p)}function v(M,p){if(typeof M!="object"||M===null)return M;var c=M[Symbol.toPrimitive];if(c!==void 0){var E=c.call(M,p);if(typeof E!="object")return E;throw new TypeError("@@toPrimitive must return a primitive value.")}return(p==="string"?String:Number)(M)}var N=at(),u=Symbol("lastResolve"),g=Symbol("lastReject"),i=Symbol("error"),y=Symbol("ended"),T=Symbol("lastPromise"),B=Symbol("handlePromise"),m=Symbol("stream");function b(M,p){return{value:M,done:p}}function A(M){var p=M[u];if(p!==null){var c=M[m].read();c!==null&&(M[T]=null,M[u]=null,M[g]=null,p(b(c,!1)))}}function o(M){process.nextTick(A,M)}function d(M,p){return function(c,E){M.then(function(){if(p[y]){c(b(void 0,!0));return}p[B](c,E)},E)}}var h=Object.getPrototypeOf(function(){}),l=Object.setPrototypeOf((x={get stream(){return this[m]},next:function(){var p=this,c=this[i];if(c!==null)return Promise.reject(c);if(this[y])return Promise.resolve(b(void 0,!0));if(this[m].destroyed)return new Promise(function(U,q){process.nextTick(function(){p[i]?q(p[i]):U(b(void 0,!0))})});var E=this[T],O;if(E)O=new Promise(d(E,this));else{var k=this[m].read();if(k!==null)return Promise.resolve(b(k,!1));O=new Promise(this[B])}return this[T]=O,O}},w(x,Symbol.asyncIterator,function(){return this}),w(x,"return",function(){var p=this;return new Promise(function(c,E){p[m].destroy(null,function(O){if(O){E(O);return}c(b(void 0,!0))})})}),x),h),_=function(p){var c,E=Object.create(l,(c={},w(c,m,{value:p,writable:!0}),w(c,u,{value:null,writable:!0}),w(c,g,{value:null,writable:!0}),w(c,i,{value:null,writable:!0}),w(c,y,{value:p._readableState.endEmitted,writable:!0}),w(c,B,{value:function(k,U){var q=E[m].read();q?(E[T]=null,E[u]=null,E[g]=null,k(b(q,!1))):(E[u]=k,E[g]=U)},writable:!0}),c));return E[T]=null,N(p,function(O){if(O&&O.code!=="ERR_STREAM_PREMATURE_CLOSE"){var k=E[g];k!==null&&(E[T]=null,E[u]=null,E[g]=null,k(O)),E[i]=O;return}var U=E[u];U!==null&&(E[T]=null,E[u]=null,E[g]=null,U(b(void 0,!0))),E[y]=!0}),p.on("readable",o.bind(null,E)),E};return Ze=_,Ze}var Qe,Ft;function dr(){return Ft||(Ft=1,Qe=function(){throw new Error("Readable.from is not available in the browser")}),Qe}var et,Lt;function Zt(){if(Lt)return et;Lt=1,et=U;var x;U.ReadableState=k,Yt().EventEmitter;var w=function(s,L){return s.listeners(L).length},I=$t(),v=Ie().Buffer,N=(typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function u(n){return v.from(n)}function g(n){return v.isBuffer(n)||n instanceof N}var i=zt,y;i&&i.debuglog?y=i.debuglog("stream"):y=function(){};var T=fr(),B=Kt(),m=Xt(),b=m.getHighWaterMark,A=Ce().codes,o=A.ERR_INVALID_ARG_TYPE,d=A.ERR_STREAM_PUSH_AFTER_EOF,h=A.ERR_METHOD_NOT_IMPLEMENTED,l=A.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,_,M,p;Be()(U,I);var c=B.errorOrDestroy,E=["error","close","destroy","pause","resume"];function O(n,s,L){if(typeof n.prependListener=="function")return n.prependListener(s,L);!n._events||!n._events[s]?n.on(s,L):Array.isArray(n._events[s])?n._events[s].unshift(L):n._events[s]=[L,n._events[s]]}function k(n,s,L){x=x||xe(),n=n||{},typeof L!="boolean"&&(L=s instanceof x),this.objectMode=!!n.objectMode,L&&(this.objectMode=this.objectMode||!!n.readableObjectMode),this.highWaterMark=b(this,n,"readableHighWaterMark",L),this.buffer=new T,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=n.emitClose!==!1,this.autoDestroy=!!n.autoDestroy,this.destroyed=!1,this.defaultEncoding=n.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,n.encoding&&(_||(_=It().StringDecoder),this.decoder=new _(n.encoding),this.encoding=n.encoding)}function U(n){if(x=x||xe(),!(this instanceof U))return new U(n);var s=this instanceof x;this._readableState=new k(n,this,s),this.readable=!0,n&&(typeof n.read=="function"&&(this._read=n.read),typeof n.destroy=="function"&&(this._destroy=n.destroy)),I.call(this)}Object.defineProperty(U.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(s){this._readableState&&(this._readableState.destroyed=s)}}),U.prototype.destroy=B.destroy,U.prototype._undestroy=B.undestroy,U.prototype._destroy=function(n,s){s(n)},U.prototype.push=function(n,s){var L=this._readableState,j;return L.objectMode?j=!0:typeof n=="string"&&(s=s||L.defaultEncoding,s!==L.encoding&&(n=v.from(n,s),s=""),j=!0),q(this,n,s,!1,j)},U.prototype.unshift=function(n){return q(this,n,null,!0,!1)};function q(n,s,L,j,Y){y("readableAddChunk",s);var V=n._readableState;if(s===null)V.reading=!1,he(n,V);else{var z;if(Y||(z=re(V,s)),z)c(n,z);else if(V.objectMode||s&&s.length>0)if(typeof s!="string"&&!V.objectMode&&Object.getPrototypeOf(s)!==v.prototype&&(s=u(s)),j)V.endEmitted?c(n,new l):$(n,V,s,!0);else if(V.ended)c(n,new d);else{if(V.destroyed)return!1;V.reading=!1,V.decoder&&!L?(s=V.decoder.write(s),V.objectMode||s.length!==0?$(n,V,s,!1):de(n,V)):$(n,V,s,!1)}else j||(V.reading=!1,de(n,V))}return!V.ended&&(V.length<V.highWaterMark||V.length===0)}function $(n,s,L,j){s.flowing&&s.length===0&&!s.sync?(s.awaitDrain=0,n.emit("data",L)):(s.length+=s.objectMode?1:L.length,j?s.buffer.unshift(L):s.buffer.push(L),s.needReadable&&oe(n)),de(n,s)}function re(n,s){var L;return!g(s)&&typeof s!="string"&&s!==void 0&&!n.objectMode&&(L=new o("chunk",["string","Buffer","Uint8Array"],s)),L}U.prototype.isPaused=function(){return this._readableState.flowing===!1},U.prototype.setEncoding=function(n){_||(_=It().StringDecoder);var s=new _(n);this._readableState.decoder=s,this._readableState.encoding=this._readableState.decoder.encoding;for(var L=this._readableState.buffer.head,j="";L!==null;)j+=s.write(L.data),L=L.next;return this._readableState.buffer.clear(),j!==""&&this._readableState.buffer.push(j),this._readableState.length=j.length,this};var ne=1073741824;function ie(n){return n>=ne?n=ne:(n--,n|=n>>>1,n|=n>>>2,n|=n>>>4,n|=n>>>8,n|=n>>>16,n++),n}function ae(n,s){return n<=0||s.length===0&&s.ended?0:s.objectMode?1:n!==n?s.flowing&&s.length?s.buffer.head.data.length:s.length:(n>s.highWaterMark&&(s.highWaterMark=ie(n)),n<=s.length?n:s.ended?s.length:(s.needReadable=!0,0))}U.prototype.read=function(n){y("read",n),n=parseInt(n,10);var s=this._readableState,L=n;if(n!==0&&(s.emittedReadable=!1),n===0&&s.needReadable&&((s.highWaterMark!==0?s.length>=s.highWaterMark:s.length>0)||s.ended))return y("read: emitReadable",s.length,s.ended),s.length===0&&s.ended?P(this):oe(this),null;if(n=ae(n,s),n===0&&s.ended)return s.length===0&&P(this),null;var j=s.needReadable;y("need readable",j),(s.length===0||s.length-n<s.highWaterMark)&&(j=!0,y("length less than watermark",j)),s.ended||s.reading?(j=!1,y("reading or ended",j)):j&&(y("do read"),s.reading=!0,s.sync=!0,s.length===0&&(s.needReadable=!0),this._read(s.highWaterMark),s.sync=!1,s.reading||(n=ae(L,s)));var Y;return n>0?Y=R(n,s):Y=null,Y===null?(s.needReadable=s.length<=s.highWaterMark,n=0):(s.length-=n,s.awaitDrain=0),s.length===0&&(s.ended||(s.needReadable=!0),L!==n&&s.ended&&P(this)),Y!==null&&this.emit("data",Y),Y};function he(n,s){if(y("onEofChunk"),!s.ended){if(s.decoder){var L=s.decoder.end();L&&L.length&&(s.buffer.push(L),s.length+=s.objectMode?1:L.length)}s.ended=!0,s.sync?oe(n):(s.needReadable=!1,s.emittedReadable||(s.emittedReadable=!0,ge(n)))}}function oe(n){var s=n._readableState;y("emitReadable",s.needReadable,s.emittedReadable),s.needReadable=!1,s.emittedReadable||(y("emitReadable",s.flowing),s.emittedReadable=!0,process.nextTick(ge,n))}function ge(n){var s=n._readableState;y("emitReadable_",s.destroyed,s.length,s.ended),!s.destroyed&&(s.length||s.ended)&&(n.emit("readable"),s.emittedReadable=!1),s.needReadable=!s.flowing&&!s.ended&&s.length<=s.highWaterMark,C(n)}function de(n,s){s.readingMore||(s.readingMore=!0,process.nextTick(pe,n,s))}function pe(n,s){for(;!s.reading&&!s.ended&&(s.length<s.highWaterMark||s.flowing&&s.length===0);){var L=s.length;if(y("maybeReadMore read 0"),n.read(0),L===s.length)break}s.readingMore=!1}U.prototype._read=function(n){c(this,new h("_read()"))},U.prototype.pipe=function(n,s){var L=this,j=this._readableState;switch(j.pipesCount){case 0:j.pipes=n;break;case 1:j.pipes=[j.pipes,n];break;default:j.pipes.push(n);break}j.pipesCount+=1,y("pipe count=%d opts=%j",j.pipesCount,s);var Y=(!s||s.end!==!1)&&n!==process.stdout&&n!==process.stderr,V=Y?_e:be;j.endEmitted?process.nextTick(V):L.once("end",V),n.on("unpipe",z);function z(r,e){y("onunpipe"),r===L&&e&&e.hasUnpiped===!1&&(e.hasUnpiped=!0,Re())}function _e(){y("onend"),n.end()}var ve=J(L);n.on("drain",ve);var Se=!1;function Re(){y("cleanup"),n.removeListener("close",Te),n.removeListener("finish",ue),n.removeListener("drain",ve),n.removeListener("error",me),n.removeListener("unpipe",z),L.removeListener("end",_e),L.removeListener("end",be),L.removeListener("data",se),Se=!0,j.awaitDrain&&(!n._writableState||n._writableState.needDrain)&&ve()}L.on("data",se);function se(r){y("ondata");var e=n.write(r);y("dest.write",e),e===!1&&((j.pipesCount===1&&j.pipes===n||j.pipesCount>1&&D(j.pipes,n)!==-1)&&!Se&&(y("false write response, pause",j.awaitDrain),j.awaitDrain++),L.pause())}function me(r){y("onerror",r),be(),n.removeListener("error",me),w(n,"error")===0&&c(n,r)}O(n,"error",me);function Te(){n.removeListener("finish",ue),be()}n.once("close",Te);function ue(){y("onfinish"),n.removeListener("close",Te),be()}n.once("finish",ue);function be(){y("unpipe"),L.unpipe(n)}return n.emit("pipe",L),j.flowing||(y("pipe resume"),L.resume()),n};function J(n){return function(){var L=n._readableState;y("pipeOnDrain",L.awaitDrain),L.awaitDrain&&L.awaitDrain--,L.awaitDrain===0&&w(n,"data")&&(L.flowing=!0,C(n))}}U.prototype.unpipe=function(n){var s=this._readableState,L={hasUnpiped:!1};if(s.pipesCount===0)return this;if(s.pipesCount===1)return n&&n!==s.pipes?this:(n||(n=s.pipes),s.pipes=null,s.pipesCount=0,s.flowing=!1,n&&n.emit("unpipe",this,L),this);if(!n){var j=s.pipes,Y=s.pipesCount;s.pipes=null,s.pipesCount=0,s.flowing=!1;for(var V=0;V<Y;V++)j[V].emit("unpipe",this,{hasUnpiped:!1});return this}var z=D(s.pipes,n);return z===-1?this:(s.pipes.splice(z,1),s.pipesCount-=1,s.pipesCount===1&&(s.pipes=s.pipes[0]),n.emit("unpipe",this,L),this)},U.prototype.on=function(n,s){var L=I.prototype.on.call(this,n,s),j=this._readableState;return n==="data"?(j.readableListening=this.listenerCount("readable")>0,j.flowing!==!1&&this.resume()):n==="readable"&&!j.endEmitted&&!j.readableListening&&(j.readableListening=j.needReadable=!0,j.flowing=!1,j.emittedReadable=!1,y("on readable",j.length,j.reading),j.length?oe(this):j.reading||process.nextTick(le,this)),L},U.prototype.addListener=U.prototype.on,U.prototype.removeListener=function(n,s){var L=I.prototype.removeListener.call(this,n,s);return n==="readable"&&process.nextTick(Q,this),L},U.prototype.removeAllListeners=function(n){var s=I.prototype.removeAllListeners.apply(this,arguments);return(n==="readable"||n===void 0)&&process.nextTick(Q,this),s};function Q(n){var s=n._readableState;s.readableListening=n.listenerCount("readable")>0,s.resumeScheduled&&!s.paused?s.flowing=!0:n.listenerCount("data")>0&&n.resume()}function le(n){y("readable nexttick read 0"),n.read(0)}U.prototype.resume=function(){var n=this._readableState;return n.flowing||(y("resume"),n.flowing=!n.readableListening,ye(this,n)),n.paused=!1,this};function ye(n,s){s.resumeScheduled||(s.resumeScheduled=!0,process.nextTick(fe,n,s))}function fe(n,s){y("resume",s.reading),s.reading||n.read(0),s.resumeScheduled=!1,n.emit("resume"),C(n),s.flowing&&!s.reading&&n.read(0)}U.prototype.pause=function(){return y("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(y("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this};function C(n){var s=n._readableState;for(y("flow",s.flowing);s.flowing&&n.read()!==null;);}U.prototype.wrap=function(n){var s=this,L=this._readableState,j=!1;n.on("end",function(){if(y("wrapped end"),L.decoder&&!L.ended){var z=L.decoder.end();z&&z.length&&s.push(z)}s.push(null)}),n.on("data",function(z){if(y("wrapped data"),L.decoder&&(z=L.decoder.write(z)),!(L.objectMode&&z==null)&&!(!L.objectMode&&(!z||!z.length))){var _e=s.push(z);_e||(j=!0,n.pause())}});for(var Y in n)this[Y]===void 0&&typeof n[Y]=="function"&&(this[Y]=(function(_e){return function(){return n[_e].apply(n,arguments)}})(Y));for(var V=0;V<E.length;V++)n.on(E[V],this.emit.bind(this,E[V]));return this._read=function(z){y("wrapped _read",z),j&&(j=!1,n.resume())},this},typeof Symbol=="function"&&(U.prototype[Symbol.asyncIterator]=function(){return M===void 0&&(M=hr()),M(this)}),Object.defineProperty(U.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(U.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(U.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(s){this._readableState&&(this._readableState.flowing=s)}}),U._fromList=R,Object.defineProperty(U.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}});function R(n,s){if(s.length===0)return null;var L;return s.objectMode?L=s.buffer.shift():!n||n>=s.length?(s.decoder?L=s.buffer.join(""):s.buffer.length===1?L=s.buffer.first():L=s.buffer.concat(s.length),s.buffer.clear()):L=s.buffer.consume(n,s.decoder),L}function P(n){var s=n._readableState;y("endReadable",s.endEmitted),s.endEmitted||(s.ended=!0,process.nextTick(H,s,n))}function H(n,s){if(y("endReadableNT",n.endEmitted,n.length),!n.endEmitted&&n.length===0&&(n.endEmitted=!0,s.readable=!1,s.emit("end"),n.autoDestroy)){var L=s._writableState;(!L||L.autoDestroy&&L.finished)&&s.destroy()}}typeof Symbol=="function"&&(U.from=function(n,s){return p===void 0&&(p=dr()),p(U,n,s)});function D(n,s){for(var L=0,j=n.length;L<j;L++)if(n[L]===s)return L;return-1}return et}var tt,Nt;function Qt(){if(Nt)return tt;Nt=1,tt=i;var x=Ce().codes,w=x.ERR_METHOD_NOT_IMPLEMENTED,I=x.ERR_MULTIPLE_CALLBACK,v=x.ERR_TRANSFORM_ALREADY_TRANSFORMING,N=x.ERR_TRANSFORM_WITH_LENGTH_0,u=xe();Be()(i,u);function g(B,m){var b=this._transformState;b.transforming=!1;var A=b.writecb;if(A===null)return this.emit("error",new I);b.writechunk=null,b.writecb=null,m!=null&&this.push(m),A(B);var o=this._readableState;o.reading=!1,(o.needReadable||o.length<o.highWaterMark)&&this._read(o.highWaterMark)}function i(B){if(!(this instanceof i))return new i(B);u.call(this,B),this._transformState={afterTransform:g.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,B&&(typeof B.transform=="function"&&(this._transform=B.transform),typeof B.flush=="function"&&(this._flush=B.flush)),this.on("prefinish",y)}function y(){var B=this;typeof this._flush=="function"&&!this._readableState.destroyed?this._flush(function(m,b){T(B,m,b)}):T(this,null,null)}i.prototype.push=function(B,m){return this._transformState.needTransform=!1,u.prototype.push.call(this,B,m)},i.prototype._transform=function(B,m,b){b(new w("_transform()"))},i.prototype._write=function(B,m,b){var A=this._transformState;if(A.writecb=b,A.writechunk=B,A.writeencoding=m,!A.transforming){var o=this._readableState;(A.needTransform||o.needReadable||o.length<o.highWaterMark)&&this._read(o.highWaterMark)}},i.prototype._read=function(B){var m=this._transformState;m.writechunk!==null&&!m.transforming?(m.transforming=!0,this._transform(m.writechunk,m.writeencoding,m.afterTransform)):m.needTransform=!0},i.prototype._destroy=function(B,m){u.prototype._destroy.call(this,B,function(b){m(b)})};function T(B,m,b){if(m)return B.emit("error",m);if(b!=null&&B.push(b),B._writableState.length)throw new N;if(B._transformState.transforming)throw new v;return B.push(null)}return tt}var rt,Ot;function pr(){if(Ot)return rt;Ot=1,rt=w;var x=Qt();Be()(w,x);function w(I){if(!(this instanceof w))return new w(I);x.call(this,I)}return w.prototype._transform=function(I,v,N){N(null,I)},rt}var nt,kt;function gr(){if(kt)return nt;kt=1;var x;function w(b){var A=!1;return function(){A||(A=!0,b.apply(void 0,arguments))}}var I=Ce().codes,v=I.ERR_MISSING_ARGS,N=I.ERR_STREAM_DESTROYED;function u(b){if(b)throw b}function g(b){return b.setHeader&&typeof b.abort=="function"}function i(b,A,o,d){d=w(d);var h=!1;b.on("close",function(){h=!0}),x===void 0&&(x=at()),x(b,{readable:A,writable:o},function(_){if(_)return d(_);h=!0,d()});var l=!1;return function(_){if(!h&&!l){if(l=!0,g(b))return b.abort();if(typeof b.destroy=="function")return b.destroy();d(_||new N("pipe"))}}}function y(b){b()}function T(b,A){return b.pipe(A)}function B(b){return!b.length||typeof b[b.length-1]!="function"?u:b.pop()}function m(){for(var b=arguments.length,A=new Array(b),o=0;o<b;o++)A[o]=arguments[o];var d=B(A);if(Array.isArray(A[0])&&(A=A[0]),A.length<2)throw new v("streams");var h,l=A.map(function(_,M){var p=M<A.length-1,c=M>0;return i(_,p,c,function(E){h||(h=E),E&&l.forEach(y),!p&&(l.forEach(y),d(h))})});return A.reduce(T)}return nt=m,nt}var Dt;function yr(){return Dt||(Dt=1,(function(x,w){w=x.exports=Zt(),w.Stream=w,w.Readable=w,w.Writable=Jt(),w.Duplex=xe(),w.Transform=Qt(),w.PassThrough=pr(),w.finished=at(),w.pipeline=gr()})(Oe,Oe.exports)),Oe.exports}/*! queue-microtask. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */var it,Pt;function _r(){if(Pt)return it;Pt=1;let x;return it=typeof queueMicrotask=="function"?queueMicrotask.bind(typeof window<"u"?window:globalThis):w=>(x||(x=Promise.resolve())).then(w).catch(I=>setTimeout(()=>{throw I},0)),it}var ot,jt;function wr(){if(jt)return ot;jt=1;function x(I,v){for(const N in v)Object.defineProperty(I,N,{value:v[N],enumerable:!0,configurable:!0});return I}function w(I,v,N){if(!I||typeof I=="string")throw new TypeError("Please pass an Error to err-code");N||(N={}),typeof v=="object"&&(N=v,v=""),v&&(N.code=v);try{return x(I,N)}catch{N.message=I.message,N.stack=I.stack;const g=function(){};return g.prototype=Object.create(Object.getPrototypeOf(I)),x(new g,N)}}return ot=w,ot}/*! simple-peer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */var st,Ut;function mr(){if(Ut)return st;Ut=1;const x=or()("simple-peer"),w=sr(),I=ur(),v=yr(),N=_r(),u=wr(),{Buffer:g}=Ie(),i=64*1024,y=5*1e3,T=5*1e3;function B(A){return A.replace(/a=ice-options:trickle\s\n/g,"")}function m(A){console.warn(A)}class b extends v.Duplex{constructor(o){if(o=Object.assign({allowHalfOpen:!1},o),super(o),this._id=I(4).toString("hex").slice(0,7),this._debug("new peer %o",o),this.channelName=o.initiator?o.channelName||I(20).toString("hex"):null,this.initiator=o.initiator||!1,this.channelConfig=o.channelConfig||b.channelConfig,this.channelNegotiated=this.channelConfig.negotiated,this.config=Object.assign({},b.config,o.config),this.offerOptions=o.offerOptions||{},this.answerOptions=o.answerOptions||{},this.sdpTransform=o.sdpTransform||(d=>d),this.streams=o.streams||(o.stream?[o.stream]:[]),this.trickle=o.trickle!==void 0?o.trickle:!0,this.allowHalfTrickle=o.allowHalfTrickle!==void 0?o.allowHalfTrickle:!1,this.iceCompleteTimeout=o.iceCompleteTimeout||y,this.destroyed=!1,this.destroying=!1,this._connected=!1,this.remoteAddress=void 0,this.remoteFamily=void 0,this.remotePort=void 0,this.localAddress=void 0,this.localFamily=void 0,this.localPort=void 0,this._wrtc=o.wrtc&&typeof o.wrtc=="object"?o.wrtc:w(),!this._wrtc)throw u(typeof window>"u"?new Error("No WebRTC support: Specify `opts.wrtc` option in this environment"):new Error("No WebRTC support: Not a supported browser"),"ERR_WEBRTC_SUPPORT");this._pcReady=!1,this._channelReady=!1,this._iceComplete=!1,this._iceCompleteTimer=null,this._channel=null,this._pendingCandidates=[],this._isNegotiating=!1,this._firstNegotiation=!0,this._batchedNegotiation=!1,this._queuedNegotiation=!1,this._sendersAwaitingStable=[],this._senderMap=new Map,this._closingInterval=null,this._remoteTracks=[],this._remoteStreams=[],this._chunk=null,this._cb=null,this._interval=null;try{this._pc=new this._wrtc.RTCPeerConnection(this.config)}catch(d){this.destroy(u(d,"ERR_PC_CONSTRUCTOR"));return}this._isReactNativeWebrtc=typeof this._pc._peerConnectionId=="number",this._pc.oniceconnectionstatechange=()=>{this._onIceStateChange()},this._pc.onicegatheringstatechange=()=>{this._onIceStateChange()},this._pc.onconnectionstatechange=()=>{this._onConnectionStateChange()},this._pc.onsignalingstatechange=()=>{this._onSignalingStateChange()},this._pc.onicecandidate=d=>{this._onIceCandidate(d)},typeof this._pc.peerIdentity=="object"&&this._pc.peerIdentity.catch(d=>{this.destroy(u(d,"ERR_PC_PEER_IDENTITY"))}),this.initiator||this.channelNegotiated?this._setupData({channel:this._pc.createDataChannel(this.channelName,this.channelConfig)}):this._pc.ondatachannel=d=>{this._setupData(d)},this.streams&&this.streams.forEach(d=>{this.addStream(d)}),this._pc.ontrack=d=>{this._onTrack(d)},this._debug("initial negotiation"),this._needsNegotiation(),this._onFinishBound=()=>{this._onFinish()},this.once("finish",this._onFinishBound)}get bufferSize(){return this._channel&&this._channel.bufferedAmount||0}get connected(){return this._connected&&this._channel.readyState==="open"}address(){return{port:this.localPort,family:this.localFamily,address:this.localAddress}}signal(o){if(!this.destroying){if(this.destroyed)throw u(new Error("cannot signal after peer is destroyed"),"ERR_DESTROYED");if(typeof o=="string")try{o=JSON.parse(o)}catch{o={}}this._debug("signal()"),o.renegotiate&&this.initiator&&(this._debug("got request to renegotiate"),this._needsNegotiation()),o.transceiverRequest&&this.initiator&&(this._debug("got request for transceiver"),this.addTransceiver(o.transceiverRequest.kind,o.transceiverRequest.init)),o.candidate&&(this._pc.remoteDescription&&this._pc.remoteDescription.type?this._addIceCandidate(o.candidate):this._pendingCandidates.push(o.candidate)),o.sdp&&this._pc.setRemoteDescription(new this._wrtc.RTCSessionDescription(o)).then(()=>{this.destroyed||(this._pendingCandidates.forEach(d=>{this._addIceCandidate(d)}),this._pendingCandidates=[],this._pc.remoteDescription.type==="offer"&&this._createAnswer())}).catch(d=>{this.destroy(u(d,"ERR_SET_REMOTE_DESCRIPTION"))}),!o.sdp&&!o.candidate&&!o.renegotiate&&!o.transceiverRequest&&this.destroy(u(new Error("signal() called with invalid signal data"),"ERR_SIGNALING"))}}_addIceCandidate(o){const d=new this._wrtc.RTCIceCandidate(o);this._pc.addIceCandidate(d).catch(h=>{!d.address||d.address.endsWith(".local")?m("Ignoring unsupported ICE candidate."):this.destroy(u(h,"ERR_ADD_ICE_CANDIDATE"))})}send(o){if(!this.destroying){if(this.destroyed)throw u(new Error("cannot send after peer is destroyed"),"ERR_DESTROYED");this._channel.send(o)}}addTransceiver(o,d){if(!this.destroying){if(this.destroyed)throw u(new Error("cannot addTransceiver after peer is destroyed"),"ERR_DESTROYED");if(this._debug("addTransceiver()"),this.initiator)try{this._pc.addTransceiver(o,d),this._needsNegotiation()}catch(h){this.destroy(u(h,"ERR_ADD_TRANSCEIVER"))}else this.emit("signal",{type:"transceiverRequest",transceiverRequest:{kind:o,init:d}})}}addStream(o){if(!this.destroying){if(this.destroyed)throw u(new Error("cannot addStream after peer is destroyed"),"ERR_DESTROYED");this._debug("addStream()"),o.getTracks().forEach(d=>{this.addTrack(d,o)})}}addTrack(o,d){if(this.destroying)return;if(this.destroyed)throw u(new Error("cannot addTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("addTrack()");const h=this._senderMap.get(o)||new Map;let l=h.get(d);if(!l)l=this._pc.addTrack(o,d),h.set(d,l),this._senderMap.set(o,h),this._needsNegotiation();else throw l.removed?u(new Error("Track has been removed. You should enable/disable tracks that you want to re-add."),"ERR_SENDER_REMOVED"):u(new Error("Track has already been added to that stream."),"ERR_SENDER_ALREADY_ADDED")}replaceTrack(o,d,h){if(this.destroying)return;if(this.destroyed)throw u(new Error("cannot replaceTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("replaceTrack()");const l=this._senderMap.get(o),_=l?l.get(h):null;if(!_)throw u(new Error("Cannot replace track that was never added."),"ERR_TRACK_NOT_ADDED");d&&this._senderMap.set(d,l),_.replaceTrack!=null?_.replaceTrack(d):this.destroy(u(new Error("replaceTrack is not supported in this browser"),"ERR_UNSUPPORTED_REPLACETRACK"))}removeTrack(o,d){if(this.destroying)return;if(this.destroyed)throw u(new Error("cannot removeTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("removeSender()");const h=this._senderMap.get(o),l=h?h.get(d):null;if(!l)throw u(new Error("Cannot remove track that was never added."),"ERR_TRACK_NOT_ADDED");try{l.removed=!0,this._pc.removeTrack(l)}catch(_){_.name==="NS_ERROR_UNEXPECTED"?this._sendersAwaitingStable.push(l):this.destroy(u(_,"ERR_REMOVE_TRACK"))}this._needsNegotiation()}removeStream(o){if(!this.destroying){if(this.destroyed)throw u(new Error("cannot removeStream after peer is destroyed"),"ERR_DESTROYED");this._debug("removeSenders()"),o.getTracks().forEach(d=>{this.removeTrack(d,o)})}}_needsNegotiation(){this._debug("_needsNegotiation"),!this._batchedNegotiation&&(this._batchedNegotiation=!0,N(()=>{this._batchedNegotiation=!1,this.initiator||!this._firstNegotiation?(this._debug("starting batched negotiation"),this.negotiate()):this._debug("non-initiator initial negotiation request discarded"),this._firstNegotiation=!1}))}negotiate(){if(!this.destroying){if(this.destroyed)throw u(new Error("cannot negotiate after peer is destroyed"),"ERR_DESTROYED");this.initiator?this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("start negotiation"),setTimeout(()=>{this._createOffer()},0)):this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("requesting negotiation from initiator"),this.emit("signal",{type:"renegotiate",renegotiate:!0})),this._isNegotiating=!0}}destroy(o){this._destroy(o,()=>{})}_destroy(o,d){this.destroyed||this.destroying||(this.destroying=!0,this._debug("destroying (error: %s)",o&&(o.message||o)),N(()=>{if(this.destroyed=!0,this.destroying=!1,this._debug("destroy (error: %s)",o&&(o.message||o)),this.readable=this.writable=!1,this._readableState.ended||this.push(null),this._writableState.finished||this.end(),this._connected=!1,this._pcReady=!1,this._channelReady=!1,this._remoteTracks=null,this._remoteStreams=null,this._senderMap=null,clearInterval(this._closingInterval),this._closingInterval=null,clearInterval(this._interval),this._interval=null,this._chunk=null,this._cb=null,this._onFinishBound&&this.removeListener("finish",this._onFinishBound),this._onFinishBound=null,this._channel){try{this._channel.close()}catch{}this._channel.onmessage=null,this._channel.onopen=null,this._channel.onclose=null,this._channel.onerror=null}if(this._pc){try{this._pc.close()}catch{}this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ontrack=null,this._pc.ondatachannel=null}this._pc=null,this._channel=null,o&&this.emit("error",o),this.emit("close"),d()}))}_setupData(o){if(!o.channel)return this.destroy(u(new Error("Data channel event is missing `channel` property"),"ERR_DATA_CHANNEL"));this._channel=o.channel,this._channel.binaryType="arraybuffer",typeof this._channel.bufferedAmountLowThreshold=="number"&&(this._channel.bufferedAmountLowThreshold=i),this.channelName=this._channel.label,this._channel.onmessage=h=>{this._onChannelMessage(h)},this._channel.onbufferedamountlow=()=>{this._onChannelBufferedAmountLow()},this._channel.onopen=()=>{this._onChannelOpen()},this._channel.onclose=()=>{this._onChannelClose()},this._channel.onerror=h=>{const l=h.error instanceof Error?h.error:new Error(`Datachannel error: ${h.message} ${h.filename}:${h.lineno}:${h.colno}`);this.destroy(u(l,"ERR_DATA_CHANNEL"))};let d=!1;this._closingInterval=setInterval(()=>{this._channel&&this._channel.readyState==="closing"?(d&&this._onChannelClose(),d=!0):d=!1},T)}_read(){}_write(o,d,h){if(this.destroyed)return h(u(new Error("cannot write after peer is destroyed"),"ERR_DATA_CHANNEL"));if(this._connected){try{this.send(o)}catch(l){return this.destroy(u(l,"ERR_DATA_CHANNEL"))}this._channel.bufferedAmount>i?(this._debug("start backpressure: bufferedAmount %d",this._channel.bufferedAmount),this._cb=h):h(null)}else this._debug("write before connect"),this._chunk=o,this._cb=h}_onFinish(){if(this.destroyed)return;const o=()=>{setTimeout(()=>this.destroy(),1e3)};this._connected?o():this.once("connect",o)}_startIceCompleteTimeout(){this.destroyed||this._iceCompleteTimer||(this._debug("started iceComplete timeout"),this._iceCompleteTimer=setTimeout(()=>{this._iceComplete||(this._iceComplete=!0,this._debug("iceComplete timeout completed"),this.emit("iceTimeout"),this.emit("_iceComplete"))},this.iceCompleteTimeout))}_createOffer(){this.destroyed||this._pc.createOffer(this.offerOptions).then(o=>{if(this.destroyed)return;!this.trickle&&!this.allowHalfTrickle&&(o.sdp=B(o.sdp)),o.sdp=this.sdpTransform(o.sdp);const d=()=>{if(this.destroyed)return;const _=this._pc.localDescription||o;this._debug("signal"),this.emit("signal",{type:_.type,sdp:_.sdp})},h=()=>{this._debug("createOffer success"),!this.destroyed&&(this.trickle||this._iceComplete?d():this.once("_iceComplete",d))},l=_=>{this.destroy(u(_,"ERR_SET_LOCAL_DESCRIPTION"))};this._pc.setLocalDescription(o).then(h).catch(l)}).catch(o=>{this.destroy(u(o,"ERR_CREATE_OFFER"))})}_requestMissingTransceivers(){this._pc.getTransceivers&&this._pc.getTransceivers().forEach(o=>{!o.mid&&o.sender.track&&!o.requested&&(o.requested=!0,this.addTransceiver(o.sender.track.kind))})}_createAnswer(){this.destroyed||this._pc.createAnswer(this.answerOptions).then(o=>{if(this.destroyed)return;!this.trickle&&!this.allowHalfTrickle&&(o.sdp=B(o.sdp)),o.sdp=this.sdpTransform(o.sdp);const d=()=>{if(this.destroyed)return;const _=this._pc.localDescription||o;this._debug("signal"),this.emit("signal",{type:_.type,sdp:_.sdp}),this.initiator||this._requestMissingTransceivers()},h=()=>{this.destroyed||(this.trickle||this._iceComplete?d():this.once("_iceComplete",d))},l=_=>{this.destroy(u(_,"ERR_SET_LOCAL_DESCRIPTION"))};this._pc.setLocalDescription(o).then(h).catch(l)}).catch(o=>{this.destroy(u(o,"ERR_CREATE_ANSWER"))})}_onConnectionStateChange(){this.destroyed||this._pc.connectionState==="failed"&&this.destroy(u(new Error("Connection failed."),"ERR_CONNECTION_FAILURE"))}_onIceStateChange(){if(this.destroyed)return;const o=this._pc.iceConnectionState,d=this._pc.iceGatheringState;this._debug("iceStateChange (connection: %s) (gathering: %s)",o,d),this.emit("iceStateChange",o,d),(o==="connected"||o==="completed")&&(this._pcReady=!0,this._maybeReady()),o==="failed"&&this.destroy(u(new Error("Ice connection failed."),"ERR_ICE_CONNECTION_FAILURE")),o==="closed"&&this.destroy(u(new Error("Ice connection closed."),"ERR_ICE_CONNECTION_CLOSED"))}getStats(o){const d=h=>(Object.prototype.toString.call(h.values)==="[object Array]"&&h.values.forEach(l=>{Object.assign(h,l)}),h);this._pc.getStats.length===0||this._isReactNativeWebrtc?this._pc.getStats().then(h=>{const l=[];h.forEach(_=>{l.push(d(_))}),o(null,l)},h=>o(h)):this._pc.getStats.length>0?this._pc.getStats(h=>{if(this.destroyed)return;const l=[];h.result().forEach(_=>{const M={};_.names().forEach(p=>{M[p]=_.stat(p)}),M.id=_.id,M.type=_.type,M.timestamp=_.timestamp,l.push(d(M))}),o(null,l)},h=>o(h)):o(null,[])}_maybeReady(){if(this._debug("maybeReady pc %s channel %s",this._pcReady,this._channelReady),this._connected||this._connecting||!this._pcReady||!this._channelReady)return;this._connecting=!0;const o=()=>{this.destroyed||this.getStats((d,h)=>{if(this.destroyed)return;d&&(h=[]);const l={},_={},M={};let p=!1;h.forEach(E=>{(E.type==="remotecandidate"||E.type==="remote-candidate")&&(l[E.id]=E),(E.type==="localcandidate"||E.type==="local-candidate")&&(_[E.id]=E),(E.type==="candidatepair"||E.type==="candidate-pair")&&(M[E.id]=E)});const c=E=>{p=!0;let O=_[E.localCandidateId];O&&(O.ip||O.address)?(this.localAddress=O.ip||O.address,this.localPort=Number(O.port)):O&&O.ipAddress?(this.localAddress=O.ipAddress,this.localPort=Number(O.portNumber)):typeof E.googLocalAddress=="string"&&(O=E.googLocalAddress.split(":"),this.localAddress=O[0],this.localPort=Number(O[1])),this.localAddress&&(this.localFamily=this.localAddress.includes(":")?"IPv6":"IPv4");let k=l[E.remoteCandidateId];k&&(k.ip||k.address)?(this.remoteAddress=k.ip||k.address,this.remotePort=Number(k.port)):k&&k.ipAddress?(this.remoteAddress=k.ipAddress,this.remotePort=Number(k.portNumber)):typeof E.googRemoteAddress=="string"&&(k=E.googRemoteAddress.split(":"),this.remoteAddress=k[0],this.remotePort=Number(k[1])),this.remoteAddress&&(this.remoteFamily=this.remoteAddress.includes(":")?"IPv6":"IPv4"),this._debug("connect local: %s:%s remote: %s:%s",this.localAddress,this.localPort,this.remoteAddress,this.remotePort)};if(h.forEach(E=>{E.type==="transport"&&E.selectedCandidatePairId&&c(M[E.selectedCandidatePairId]),(E.type==="googCandidatePair"&&E.googActiveConnection==="true"||(E.type==="candidatepair"||E.type==="candidate-pair")&&E.selected)&&c(E)}),!p&&(!Object.keys(M).length||Object.keys(_).length)){setTimeout(o,100);return}else this._connecting=!1,this._connected=!0;if(this._chunk){try{this.send(this._chunk)}catch(O){return this.destroy(u(O,"ERR_DATA_CHANNEL"))}this._chunk=null,this._debug('sent chunk from "write before connect"');const E=this._cb;this._cb=null,E(null)}typeof this._channel.bufferedAmountLowThreshold!="number"&&(this._interval=setInterval(()=>this._onInterval(),150),this._interval.unref&&this._interval.unref()),this._debug("connect"),this.emit("connect")})};o()}_onInterval(){!this._cb||!this._channel||this._channel.bufferedAmount>i||this._onChannelBufferedAmountLow()}_onSignalingStateChange(){this.destroyed||(this._pc.signalingState==="stable"&&(this._isNegotiating=!1,this._debug("flushing sender queue",this._sendersAwaitingStable),this._sendersAwaitingStable.forEach(o=>{this._pc.removeTrack(o),this._queuedNegotiation=!0}),this._sendersAwaitingStable=[],this._queuedNegotiation?(this._debug("flushing negotiation queue"),this._queuedNegotiation=!1,this._needsNegotiation()):(this._debug("negotiated"),this.emit("negotiated"))),this._debug("signalingStateChange %s",this._pc.signalingState),this.emit("signalingStateChange",this._pc.signalingState))}_onIceCandidate(o){this.destroyed||(o.candidate&&this.trickle?this.emit("signal",{type:"candidate",candidate:{candidate:o.candidate.candidate,sdpMLineIndex:o.candidate.sdpMLineIndex,sdpMid:o.candidate.sdpMid}}):!o.candidate&&!this._iceComplete&&(this._iceComplete=!0,this.emit("_iceComplete")),o.candidate&&this._startIceCompleteTimeout())}_onChannelMessage(o){if(this.destroyed)return;let d=o.data;d instanceof ArrayBuffer&&(d=g.from(d)),this.push(d)}_onChannelBufferedAmountLow(){if(this.destroyed||!this._cb)return;this._debug("ending backpressure: bufferedAmount %d",this._channel.bufferedAmount);const o=this._cb;this._cb=null,o(null)}_onChannelOpen(){this._connected||this.destroyed||(this._debug("on channel open"),this._channelReady=!0,this._maybeReady())}_onChannelClose(){this.destroyed||(this._debug("on channel close"),this.destroy())}_onTrack(o){this.destroyed||o.streams.forEach(d=>{this._debug("on track"),this.emit("track",o.track,d),this._remoteTracks.push({track:o.track,stream:d}),!this._remoteStreams.some(h=>h.id===d.id)&&(this._remoteStreams.push(d),N(()=>{this._debug("on stream"),this.emit("stream",d)}))})}_debug(){const o=[].slice.call(arguments);o[0]="["+this._id+"] "+o[0],x.apply(null,o)}}return b.WEBRTC_SUPPORT=!!w(),b.config={iceServers:[{urls:["stun:stun.l.google.com:19302","stun:global.stun.twilio.com:3478"]}],sdpSemantics:"unified-plan"},b.channelConfig={},st=b,st}var br=mr();const qt=er(br);function Er(x){return ce({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0zm0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M19 11h-1.7c0 .74-.16 1.43-.43 2.05l1.23 1.23c.56-.98.9-2.09.9-3.28zm-4.02.17c0-.06.02-.11.02-.17V5c0-1.66-1.34-3-3-3S9 3.34 9 5v.18l5.98 5.99zM4.27 3 3 4.27l6.01 6.01V11c0 1.66 1.33 3 2.99 3 .22 0 .44-.03.65-.08l1.66 1.66c-.71.33-1.5.52-2.31.52-2.76 0-5.3-2.1-5.3-5.1H5c0 3.41 2.72 6.23 6 6.72V21h2v-3.28c.91-.13 1.77-.45 2.54-.9L19.73 21 21 19.73 4.27 3z"},child:[]}]})(x)}function vr(x){return ce({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M12 14c1.66 0 2.99-1.34 2.99-3L15 5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3zm5.3-3c0 3-2.54 5.1-5.3 5.1S6.7 14 6.7 11H5c0 3.41 2.72 6.23 6 6.72V21h2v-3.28c3.28-.48 6-3.3 6-6.72h-1.7z"},child:[]}]})(x)}function Rr(x){return ce({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M6 19h4V5H6v14zm8-14v14h4V5h-4z"},child:[]}]})(x)}function xr(x){return ce({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M8 5v14l11-7z"},child:[]}]})(x)}function Cr(x){return ce({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0zm0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"m21 6.5-4 4V7c0-.55-.45-1-1-1H9.82L21 17.18V6.5zM3.27 2 2 3.27 4.73 6H4c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h12c.21 0 .39-.08.54-.18L19.73 21 21 19.73 3.27 2z"},child:[]}]})(x)}function Ht(x){return ce({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M17 10.5V7c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h12c.55 0 1-.45 1-1v-3.5l4 4v-11l-4 4z"},child:[]}]})(x)}function Sr(x){return ce({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M16.5 12A4.5 4.5 0 0 0 14 7.97v2.21l2.45 2.45c.03-.2.05-.41.05-.63zm2.5 0c0 .94-.2 1.82-.54 2.64l1.51 1.51A8.796 8.796 0 0 0 21 12c0-4.28-2.99-7.86-7-8.77v2.06c2.89.86 5 3.54 5 6.71zM4.27 3 3 4.27 7.73 9H3v6h4l5 5v-6.73l4.25 4.25c-.67.52-1.42.93-2.25 1.18v2.06a8.99 8.99 0 0 0 3.69-1.81L19.73 21 21 19.73l-9-9L4.27 3zM12 4 9.91 6.09 12 8.18V4z"},child:[]}]})(x)}function Tr(x){return ce({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M3 9v6h4l5 5V4L7 9H3zm13.5 3A4.5 4.5 0 0 0 14 7.97v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"},child:[]}]})(x)}function Wt(x){return ce({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M12 9c-1.6 0-3.15.25-4.6.72v3.1c0 .39-.23.74-.56.9-.98.49-1.87 1.12-2.66 1.85-.18.18-.43.28-.7.28-.28 0-.53-.11-.71-.29L.29 13.08a.956.956 0 0 1-.29-.7c0-.28.11-.53.29-.71C3.34 8.78 7.46 7 12 7s8.66 1.78 11.71 4.67c.18.18.29.43.29.71 0 .28-.11.53-.29.71l-2.48 2.48c-.18.18-.43.29-.71.29-.27 0-.52-.11-.7-.28a11.27 11.27 0 0 0-2.67-1.85.996.996 0 0 1-.56-.9v-3.1C15.15 9.25 13.6 9 12 9z"},child:[]}]})(x)}function Ar(x){return ce({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M20.01 15.38c-1.23 0-2.42-.2-3.53-.56a.977.977 0 0 0-1.01.24l-1.57 1.97c-2.83-1.35-5.48-3.9-6.89-6.83l1.95-1.66c.27-.28.35-.67.24-1.02-.37-1.11-.56-2.3-.56-3.53 0-.54-.45-.99-.99-.99H4.19C3.65 3 3 3.24 3 3.99 3 13.28 10.73 21 20.01 21c.71 0 .99-.63.99-1.18v-3.45c0-.54-.45-.99-.99-.99z"},child:[]}]})(x)}function Ir(x){return ce({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M20 5h-3.17L15 3H9L7.17 5H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm-8 13c-2.76 0-5-2.24-5-5H5l2.5-2.5L10 13H8c0 2.21 1.79 4 4 4 .58 0 1.13-.13 1.62-.35l.74.74c-.71.37-1.5.61-2.36.61zm4.5-2.5L14 13h2c0-2.21-1.79-4-4-4-.58 0-1.13.13-1.62.35l-.74-.73C10.35 8.24 11.14 8 12 8c2.76 0 5 2.24 5 5h2l-2.5 2.5z"},child:[]}]})(x)}const Br=we.div`
  position: fixed;
  top: 0; left: 0; right: 0; bottom: 0;
  background: rgba(0,0,0,0.9);
  z-index: 2000;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
`,Mr=we.div`
  display: flex;
  justify-content: center;
  align-items: center;
  flex-wrap: wrap;
  width: 100%;
  height: 80%;
  
  @media (max-width: 768px) {
    flex-direction: column;
    height: auto;
    flex: 1;
    overflow-y: auto;
  }
`,Vt=we.video`
  width: 100%;
  max-width: 600px;
  height: auto;
  border-radius: 8px;
  margin: 10px;
  background: black;
  transform: scaleX(-1); // Mirror effect

  @media (max-width: 768px) {
    max-width: 100%;
    margin: 5px 0;
  }
`,Fr=we.div`
  display: flex;
  gap: 15px;
  margin-top: auto; /* Push to bottom */
  flex-wrap: wrap;
  justify-content: center;
  padding: 20px;
  width: 100%;
  background: rgba(0,0,0,0.5); /* Semi-transparent background for better visibility */
  backdrop-filter: blur(5px);
  
  @media (max-width: 768px) {
      padding-bottom: 40px; /* Extra padding for mobile bottom bar */
      gap: 10px;
  }
`,Lr=we.div`
    position: absolute;
    bottom: 50px;
    left: 0;
    right: 0;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 20px;
    z-index: 2002;
    padding: 20px;
    background: linear-gradient(to top, rgba(0,0,0,0.9), transparent);
`,Ee=we.button`
  background: ${x=>x.danger?"#ff4d4f":"#333"};
  color: #ffffff;
  border: none;
  width: 80px;
  height: 80px;
  border-radius: 50%;
  display: flex;
  justify-content: center;
  align-items: center;
  font-size: 1.5rem;
  cursor: pointer;
  box-shadow: 0 4px 10px rgba(0,0,0,0.3);
  
  &:hover {
    background: ${x=>x.danger?"#d9363e":"#555"};
    transform: scale(1.1);
  }

  svg {
    display: block !important;
    width: 40px;
    height: 40px;
    fill: #ffffff !important;
    color: #ffffff !important;
    stroke: none !important;
  }

  @media (max-width: 768px) {
    width: 100px;
    height: 100px;
    
    svg {
        width: 50px;
        height: 50px;
    }
  }
`,Nr=we.button`
  padding: 15px 40px;
  background: #00C853;
  color: white;
  border: none;
  border-radius: 50px;
  font-size: 1.5rem;
  font-weight: bold;
  cursor: pointer;
  box-shadow: 0 4px 15px rgba(0, 200, 83, 0.4);
  display: flex;
  align-items: center;
  gap: 15px;
  animation: pulse 1.5s infinite;
  z-index: 2001;

  svg {
      width: 50px;
      height: 50px;
      fill: currentColor;
  }

  @media (max-width: 768px) {
      padding: 15px 30px;
      font-size: 1.2rem;
      width: 90%;
      justify-content: center;
  }

  @keyframes pulse {
    0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(0, 200, 83, 0.7); }
    70% { transform: scale(1.05); box-shadow: 0 0 0 10px rgba(0, 200, 83, 0); }
    100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(0, 200, 83, 0); }
  }
`,Or=we.div`
  color: white;
  margin-bottom: 20px;
  font-size: 1.5rem;
  text-align: center;
  font-weight: 500;
  text-shadow: 0 2px 4px rgba(0,0,0,0.5);
`,Pr=({otherUserId:x,otherUserName:w,isCaller:I,callType:v,incomingCallData:N,onClose:u})=>{const{socket:g}=X.useContext(tr),{user:i}=X.useContext(rr),[y,T]=X.useState(null),[B,m]=X.useState(null),[b,A]=X.useState(!1),[o,d]=X.useState(!0),[h,l]=X.useState(v==="video"),[_,M]=X.useState(!1),[p,c]=X.useState(!1),[E,O]=X.useState(I?`Calling ${w||"User"}...`:"Incoming Call..."),[k,U]=X.useState("user"),q=X.useRef(),$=X.useRef(),re=X.useRef(),ne=X.useRef(),ie=X.useRef(null),ae=X.useRef(null),he=X.useRef(null),oe=()=>{he.current&&(clearInterval(he.current),he.current=null),ae.current&&(ae.current.close().catch(D=>console.error(D)),ae.current=null)};X.useEffect(()=>(I&&!b?(()=>{try{const n=window.AudioContext||window.webkitAudioContext,s=new n;ae.current=s;const L=()=>{if(!s||s.state==="closed")return;s.state==="suspended"&&s.resume();const j=s.currentTime,Y=s.createOscillator(),V=s.createOscillator(),z=s.createGain();Y.frequency.value=440,V.frequency.value=480,Y.connect(z),V.connect(z),z.connect(s.destination),z.gain.setValueAtTime(0,j),z.gain.linearRampToValueAtTime(.1,j+.1),z.gain.setValueAtTime(.1,j+1.8),z.gain.linearRampToValueAtTime(0,j+2),Y.start(j),V.start(j),Y.stop(j+2),V.stop(j+2)};L(),he.current=setInterval(L,3e3)}catch(n){console.error("Ringing sound failed:",n)}})():oe(),oe),[I,b]),X.useEffect(()=>{$.current&&B&&($.current.srcObject=B,$.current.muted=!1,$.current.onloadedmetadata=()=>{$.current.play().catch(D=>console.error("Remote video auto-play failed:",D))})},[B,b]),X.useEffect(()=>{if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia){alert(`Media devices not supported or blocked by browser security (non-HTTPS).

To test on mobile/LAN, you must:
1. Use localhost/127.0.0.1 on the host machine
2. OR enable 'Insecure origins treated as secure' in chrome://flags on the client device.`),O("Media Access Blocked (Insecure Origin)");return}return navigator.mediaDevices.getUserMedia({video:v==="video",audio:!0}).then(D=>{T(D),ne.current=D,q.current&&(q.current.srcObject=D),!I&&N&&O(`Incoming ${N.type==="video"?"Video":"Audio"} Call...`)}).catch(D=>{console.error("Error accessing media devices:",D);let n="Error accessing camera/microphone";D.name==="NotAllowedError"&&(n="Permission denied. Allow camera/mic access."),D.name==="NotFoundError"&&(n="No camera/microphone found."),D.name==="NotReadableError"&&(n="Camera/mic is in use by another app."),O(n),alert(`${n}
Note: Browsers often block media on http://IP_ADDRESS. Use localhost or enable 'Insecure origins treated as secure' flag.`)}),()=>{ne.current&&ne.current.getTracks().forEach(D=>D.stop()),re.current&&re.current.destroy()}},[]);const ge=()=>{if(y){const D=!_;D?y.getTracks().forEach(n=>{n.enabled=!1}):(y.getAudioTracks().forEach(n=>{n.enabled=o}),y.getVideoTracks().forEach(n=>{n.enabled=h})),M(D)}},de=()=>{$.current&&($.current.muted=!p,c(!p))},[pe,J]=X.useState([{urls:"stun:stun.l.google.com:19302"},{urls:"stun:global.stun.twilio.com:3478"}]);X.useEffect(()=>{let D=!0;return(async()=>{var n,s;try{const L=await api.get("/ice");D&&((s=(n=L.data)==null?void 0:n.iceServers)!=null&&s.length)&&J(L.data.iceServers)}catch{console.warn("Using default ICE servers due to fetch error")}})(),()=>{D=!1}},[]);const Q=()=>{g&&(g.off("call_accepted"),g.off("ice_candidate"),g.off("call_rejected"))};X.useEffect(()=>()=>{Q()},[]);const le=()=>{A(!0),ie.current=Date.now();try{const D=new qt({initiator:!1,trickle:!0,stream:y,config:{iceServers:pe}});D.on("signal",n=>{n.type==="answer"||n.type==="pranswer"||n.sdp?g.emit("answer_call",{signal:n,to:N.from}):n.candidate&&g.emit("ice_candidate",{candidate:n,to:N.from})}),Q(),g.on("ice_candidate",n=>{try{D.signal(n)}catch{}}),g.on("call_rejected",()=>{O("Call rejected"),fe("rejected"),u()}),D.on("stream",n=>{console.log("Remote Stream Received (Caller):",n),m(n)}),D.on("error",n=>{console.error("Peer error:",n),!(n.code==="ERR_DATA_CHANNEL"||n.message.includes("User-Initiated Abort")||n.message.includes("Close called"))&&O("Call Error: "+n.message)}),D.signal(N.signal),re.current=D,O("Connected")}catch(D){console.error("Peer creation failed:",D),O("Call failed to start")}},ye=()=>{try{const D=new qt({initiator:!0,trickle:!0,stream:y,config:{iceServers:pe}});D.on("signal",n=>{n.type==="offer"?g.emit("call_user",{userToCall:x,signalData:n,from:i.id,name:i.username,type:v}):n.candidate?g.emit("ice_candidate",{candidate:n,to:x}):n.sdp?g.emit("call_user",{userToCall:x,signalData:n,from:i.id,name:i.username,type:v}):g.emit("ice_candidate",{candidate:n,to:x})}),D.on("stream",n=>{console.log("Remote Stream Received (Caller):",n),m(n)}),D.on("error",n=>{console.error("Peer error:",n),!(n.code==="ERR_DATA_CHANNEL"||n.message.includes("User-Initiated Abort"))&&O("Call Error: "+n.message)}),Q(),g.on("call_accepted",n=>{oe(),A(!0),ie.current=Date.now(),D.signal(n),O("Connected")}),g.on("ice_candidate",n=>{try{D.signal(n)}catch{}}),g.on("call_rejected",()=>{O("Call rejected"),fe("rejected"),u()}),re.current=D}catch(D){console.error("Peer creation failed:",D),O("Call failed to start")}};X.useEffect(()=>{if(!I&&!N)return;const D=setTimeout(()=>{b||(O("Call timeout"),fe(I?"missed":"rejected"),u())},25e3);return()=>clearTimeout(D)},[I,N,b]),X.useEffect(()=>{I&&y&&!re.current&&ye()},[y,I]),X.useEffect(()=>{if(g)return g.on("end_call",()=>{u()}),()=>g.off("end_call")},[g,u]);const fe=async D=>{if(!x)return;let n=0;ie.current&&D==="completed"&&(n=Math.round((Date.now()-ie.current)/1e3));try{await api.post("/calls/save",{callerId:I?i.id:x,receiverId:I?x:i.id,type:v,status:D,duration:n})}catch(s){console.error("Failed to save call history:",s)}},C=()=>{re.current&&re.current.destroy(),y&&y.getTracks().forEach(n=>n.stop()),ne.current&&(ne.current.getTracks().forEach(n=>n.stop()),ne.current=null);let D="missed";b?D="completed":I?D="missed":D="rejected",fe(D),b||g.emit("reject_call",{to:x}),g.emit("end_call",{to:x}),u()},R=()=>{d(!o),y&&(y.getAudioTracks()[0].enabled=!o)},P=()=>{if(l(!h),y){const D=y.getVideoTracks()[0];D&&(D.enabled=!h)}},H=async()=>{if(v!=="video")return;const D=k==="user"?"environment":"user";U(D);try{y&&y.getTracks().forEach(s=>s.stop());const n=await navigator.mediaDevices.getUserMedia({video:{facingMode:D},audio:!0});if(T(n),q.current&&(q.current.srcObject=n),re.current){const s=n.getVideoTracks()[0],L=re.current._pc.getSenders().find(j=>j.track.kind==="video");L&&L.replaceTrack(s)}n.getAudioTracks()[0].enabled=o,n.getVideoTracks()[0].enabled=h}catch(n){console.error("Failed to switch camera:",n),O("Camera Switch Failed")}};return W.jsxs(Br,{children:[W.jsx(Or,{children:E}),!b&&!I&&W.jsxs(Lr,{children:[W.jsxs("div",{style:{display:"flex",gap:"40px",justifyContent:"center",width:"100%"},children:[W.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"5px"},children:[W.jsx(Ee,{danger:!0,onClick:C,style:{width:100,height:100},children:W.jsx(Wt,{style:{width:50,height:50}})}),W.jsx("span",{style:{color:"white",fontSize:"1.2rem",fontWeight:"bold"},children:"Decline"})]}),W.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"5px"},children:[W.jsx(Nr,{onClick:le,style:{width:100,height:100,padding:0,justifyContent:"center",borderRadius:"50%"},children:(N==null?void 0:N.type)==="audio"?W.jsx(Ar,{style:{width:50,height:50}}):W.jsx(Ht,{style:{width:50,height:50}})}),W.jsx("span",{style:{color:"white",fontSize:"1.2rem",fontWeight:"bold"},children:"Accept"})]})]}),W.jsx("span",{style:{color:"white",opacity:.8,fontSize:"1.2rem",marginTop:"10px"},children:"Incoming Call..."})]}),W.jsxs(Mr,{children:[W.jsxs("div",{style:{position:"relative",margin:"10px",width:"100%",maxWidth:"600px"},children:[(!y||!h)&&W.jsx("div",{style:{width:"100%",height:"0",paddingBottom:"75%",background:"black",position:"relative",borderRadius:"8px"},children:W.jsx("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,display:"flex",alignItems:"center",justifyContent:"center"},children:W.jsx(lt,{user:i,size:"80px"})})}),W.jsx(Vt,{playsInline:!0,muted:!0,ref:q,autoPlay:!0,style:{display:y&&h?"block":"none"}}),W.jsx("span",{style:{position:"absolute",bottom:10,left:10,color:"white",background:"rgba(0,0,0,0.5)",padding:"2px 5px",borderRadius:4},children:"You"})]}),b?W.jsxs("div",{style:{position:"relative",margin:"10px",width:"100%",maxWidth:"600px"},children:[W.jsx(Vt,{playsInline:!0,ref:$,autoPlay:!0}),W.jsx("span",{style:{position:"absolute",bottom:10,left:10,color:"white",background:"rgba(0,0,0,0.5)",padding:"2px 5px",borderRadius:4},children:w||"Remote"})]}):W.jsx("div",{style:{position:"relative",margin:"10px",width:"100%",maxWidth:"600px"},children:W.jsx("div",{style:{width:"100%",height:"0",paddingBottom:"75%",background:"rgba(255,255,255,0.1)",position:"relative",borderRadius:"8px"},children:W.jsxs("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[W.jsx(lt,{user:{username:w},size:"80px"}),W.jsx("div",{style:{color:"white",marginTop:"10px",fontWeight:"bold"},children:w})]})})})]}),(b||I)&&W.jsxs(Fr,{children:[W.jsx(Ee,{onClick:R,title:o?"Mute Mic":"Unmute Mic",children:o?W.jsx(vr,{}):W.jsx(Er,{})}),v==="video"&&W.jsx(Ee,{onClick:P,title:h?"Turn Camera Off":"Turn Camera On",children:h?W.jsx(Ht,{}):W.jsx(Cr,{})}),W.jsx(Ee,{onClick:de,title:p?"Unmute Speaker":"Mute Speaker",children:p?W.jsx(Sr,{}):W.jsx(Tr,{})}),v==="video"&&W.jsx(Ee,{onClick:H,title:"Switch Camera",children:W.jsx(Ir,{})}),W.jsx(Ee,{onClick:ge,title:_?"Resume Call":"Hold Call",children:_?W.jsx(xr,{}):W.jsx(Rr,{})}),W.jsx(Ee,{danger:!0,onClick:C,title:"End Call",children:W.jsx(Wt,{})})]})]})};export{Pr as default};
